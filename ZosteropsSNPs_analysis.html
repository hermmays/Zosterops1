<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Distance trees, PCA, UMAP, and DAPC analyses – Zosterops Methods and Results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-b663525e4b92bb903b2199e2d401bf36.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-95a2ced3787879bf47d026b70c7a7c79.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Zosterops Methods and Results</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ZosteropsMaps.html"> 
<span class="menu-text">Sampling Maps</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Summary_Sanger.html"> 
<span class="menu-text">Sanger sequencing summary statistics and trees</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Zosterops_StarBEAST2.html"> 
<span class="menu-text">StarBEAST2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ZosteropsBPP.html"> 
<span class="menu-text">BPP and GDI based species delimitation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./ZosteropsSNPs_analysis.html" aria-current="page"> 
<span class="menu-text">Distance trees, PCA, UMAP, and DAPC analyses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Zosterops_SNPFst.html"> 
<span class="menu-text">Genetic differentiation and biogeographic breaks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Zosterops_SVDQ.html"> 
<span class="menu-text">Species trees and delimitation with SVDQuartets, PICL, and DELINEATE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ZosteropsMorphometrics.html"> 
<span class="menu-text">Linear morphometrics</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#msn-distance-tree-pca-umap-and-dapc" id="toc-msn-distance-tree-pca-umap-and-dapc" class="nav-link active" data-scroll-target="#msn-distance-tree-pca-umap-and-dapc">MSN, Distance tree, PCA, UMAP, and DAPC</a>
  <ul class="collapse">
  <li><a href="#goals" id="toc-goals" class="nav-link" data-scroll-target="#goals">Goals</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting started</a></li>
  <li><a href="#data-files" id="toc-data-files" class="nav-link" data-scroll-target="#data-files">Data files</a></li>
  <li><a href="#taxa-and-populations" id="toc-taxa-and-populations" class="nav-link" data-scroll-target="#taxa-and-populations">Taxa and populations</a></li>
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#vcf-file" id="toc-vcf-file" class="nav-link" data-scroll-target="#vcf-file">VCF file</a></li>
  <li><a href="#color-settings" id="toc-color-settings" class="nav-link" data-scroll-target="#color-settings">Color settings</a></li>
  <li><a href="#minimum-spanning-network-msn" id="toc-minimum-spanning-network-msn" class="nav-link" data-scroll-target="#minimum-spanning-network-msn">Minimum spanning network (MSN)</a></li>
  <li><a href="#distance-tree" id="toc-distance-tree" class="nav-link" data-scroll-target="#distance-tree">Distance tree</a></li>
  <li><a href="#principal-component-analysis-pca" id="toc-principal-component-analysis-pca" class="nav-link" data-scroll-target="#principal-component-analysis-pca">Principal component analysis (PCA)</a></li>
  <li><a href="#uniform-manifold-approximation-and-projection-umap" id="toc-uniform-manifold-approximation-and-projection-umap" class="nav-link" data-scroll-target="#uniform-manifold-approximation-and-projection-umap">Uniform manifold approximation and projection (UMAP)</a></li>
  <li><a href="#discriminant-analysis-of-principal-components-dapc" id="toc-discriminant-analysis-of-principal-components-dapc" class="nav-link" data-scroll-target="#discriminant-analysis-of-principal-components-dapc">Discriminant analysis of principal components (DAPC)</a></li>
  <li><a href="#close-log" id="toc-close-log" class="nav-link" data-scroll-target="#close-log">Close log</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Distance trees, PCA, UMAP, and DAPC analyses</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="msn-distance-tree-pca-umap-and-dapc" class="level1">
<h1>MSN, Distance tree, PCA, UMAP, and DAPC</h1>
<section id="goals" class="level2">
<h2 class="anchored" data-anchor-id="goals">Goals</h2>
<p>What follows is an analysis of the Zosterops single nucleotide polymorphism (SNP) data from our double digest restriction-site associated DNA (ddRAD) library. This analysis seeks to describe general metrics of diversity and variation in East Asian Zosterops and makes some attempt to assess the utility of these data in clustering individuals by putative taxonomic and population groups.</p>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting started</h2>
<p>We are using R version 4.4.2, RStudio version 2024.09.1 for the analysis. Quarto version 1.6.39 for Mac OS was used to document the workflow. Set the working directory in RStudio to one where the <code>vcf.gz</code> zipped data file and a <code>txt</code> file denoting the identity of the samples are accessible.</p>
</section>
<section id="data-files" class="level2">
<h2 class="anchored" data-anchor-id="data-files">Data files</h2>
<p>This analysis requires the following data files.</p>
<ul>
<li><p><code>zost.filtered.snps.vcf.gz</code> The gzipped file containing the filtered SNP data in variant call format (VCF) (see DeRaad et al.&nbsp;2024 for details on creation of the ddRAD library and filtering the SNP dataset) <span class="citation" data-cites="deraad2024">(<a href="#ref-deraad2024" role="doc-biblioref">DeRaad et al. 2024</a>)</span></p></li>
<li><p><code>ZosteropsPOPS4.txt</code> The text file containing the taxon and locale data for each individual sample in the SNP dataset.</p></li>
</ul>
</section>
<section id="taxa-and-populations" class="level2">
<h2 class="anchored" data-anchor-id="taxa-and-populations">Taxa and populations</h2>
<p>For this run the taxon file we are using is <code>ZosteropsPOPS4.txt</code> containing the following samples. Samples of the migratory <em>Zosterops erythropleurus</em> are from breeding and non-breeding sites. Breeding sites for <em>Z. erythropleurus</em> are denoted RUSSIAb and non-breeding sites from Vietnam and denoted VIETNAMnb with <em>b</em> indicating breeding site samples and <em>nb</em> indicating non-breeding site samples.</p>
<pre><code>SAMPLE TAXON LOCALE 
ZJlo012 japonicus KIKAI 
ZJlo015 japonicus AMAMI 
ZJlo016 japonicus MIYAKOJIMA 
ZJlo017 japonicus IRIOMOTE 
ZJlo021 japonicus TOKUNOSHIMA 
ZJlo022 japonicus TOKUNOSHIMA 
ZJlo024 japonicus YONAGUMI 
ZJlo031 japonicus KUMEJIMA 
ZJlo045 japonicus AMAMI 
ZJlo046 japonicus MIYAKOJIMA 
ZJlo050 japonicus OKINOERABU 
ZJlo052 japonicus OKINOERABU 
ZJlo055 japonicus KIKAI 
ZJja001 japonicus GEOJE 
ZJja002 japonicus GEOJE 
ZJja003 japonicus JEJU 
ZJja004 japonicus JEJU 
ZJja005 japonicus JEJU 
ZJja009 japonicus HEUKSANDO 
ZJja010 japonicus HEUKSANDO 
ZJja012 japonicus HONSHU 
ZJja013 japonicus HONSHU 
ZJja014 japonicus HONSHU 
ZJja016 japonicus SHIKOKU 
ZJja030 japonicus HEUKSANDO 
ZJal003 japonicus_alani HAHAJIMA 
Zjal004 japonicus_alani HAHAJIMA 
ZJal005 japonicus_alani HAHAJIMA 
ZJal010 japonicus_alani ANEJIMA 
ZJal011 japonicus_alani ANEJIMA 
ZJal012 japonicus_alani ANEJIMA 
ZJal020 japonicus_alani IWOJIMA 
ZJst007 japonicus KOZUSHIMA 
ZJst009 japonicus KOZUSHIMA 
ZJst010 japonicus KOZUSHIMA 
ZJst012 japonicus MIYAKEJIMA 
ZJst014 japonicus MIYAKEJIMA 
ZJst015 japonicus MIYAKEJIMA 
ZJin001 japonicus KAGOSHIMA 
ZJin003 japonicus KAGOSHIMA 
ZJsi002 simplex TAIWAN 
ZJsi017 simplex GUANGXI 
ZJsi032 simplex GUANGXI 
ZJsi023 simplex GUANGDONG 
ZJsi024 simplex GUANGDONG 
ZJsi027 simplex GUANGXI 
ZJsi028 simplex GUANGXI 
ZJsi029 simplex GUANGXI 
ZJsi031 simplex GUANGXI 
ZPxx001 simplex SINGAPORE 
ZPxx002 simplex SINGAPORE 
ZMxx002 meyeni BATAN 
ZMxx003 meyeni LANYU 
ZMxx004 meyeni LANYU 
ZMxx005 meyeni LANYU 
ZMxx006 meyeni LANYU 
ZMOxx001 montanus_SOUTH PANAY 
ZMOxx002 montanus_SOUTH PANAY 
ZMOxx003 montanus_SOUTH PANAY 
ZMOxx005 montanus_SOUTH PANAY 
ZMOha001 montanus_NORTH MINDORO 
ZMOwh002 montanus_NORTH LUZON 
ZMOwh003 montanus_NORTH LUZON 
ZMOwh004 montanus_NORTH LUZON 
ZMOwh005 montanus_NORTH LUZON 
ZMOwh006 montanus_NORTH LUZON 
ZMOvu002 montanus_SOUTH MINDANAO 
ZMOvu003 montanus_SOUTH MINDANAO 
ZMOvu004 montanus_SOUTH MINDANAO 
ZMOvu005 montanus_SOUTH MINDANAO 
ZMOmo001 montanus_SOUTH SULAWESI 
ZMOpa001 montanus_PALAWAN PALAWAN 
ZMOpa002 montanus_PALAWAN PALAWAN 
ZNni001 nigrorum PANAY 
ZERxx002 erythropleurus RUSSIAb 
ZERxx004 erythropleurus RUSSIAb 
ZERxx005 erythropleurus RUSSIAb 
Zsim23588 simplex VIETNAM 
Zsim28142 simplex VIETNAM 
Zsim30897 palpebrosus VIETNAM 
Zpal23498 palpebrosus VIETNAM 
Zpal23522 palpebrosus VIETNAM 
Zmon20893 montanus_SOUTH NEGROS
Zmon20892 montanus_SOUTH NEGROS 
Zmon20902 montanus_SOUTH NEGROS 
Zmon20909 montanus_SOUTH NEGROS 
Zsim31166 montanus_SOUTH JAVA 
Zsim31159 montanus_SOUTH JAVA 
Zmey17876 meyeni BATAN 
Zmey17877 meyeni BATAN 
Zmey17852 meyeni BATAN 
Zmey17922 meyeni SABTANG 
Zmey17920 meyeni SABTANG 
Zmey17925 meyeni SABTANG 
Zmey17923 meyeni SABTANG 
Zery28090 erythropleurus VIETNAMnb 
Zery28091 erythropleurus VIETNAMnb 
Zery28088 erythropleurus VIETNAMnb 
Zni10863 nigrorum CAMIGUINNORTE 
Zni14341 nigrorum CAMIGUINSUR 
Zni19650 nigrorum LUZON 
Zni17984 nigrorum LUZON 
ZjaDOT-10981 palpebrosus VIETNAM 
ZjaDOT-5235 simplex TAIWAN 
Z_LA_122866_2 simplex LOSANGELES 
Z_LA_122577_2 simplex LOSANGELES 
Z_LA_122188_2 simplex LOSANGELES 
Zsim13809 simplex GUIZHOU 
Zsim13773 simplex GUIZHOU 
Zsim6797 simplex HUNAN 
Zsim10336 simplex GUANGXI 
Zsim11362 simplex GUIZHOU 
Zsim11102 simplex GUIZHOU 
Zsim11220 simplex GUIZHOU 
Zmon20899 montanus_SOUTH NEGROS 
Zmon28375 montanus_SOUTH MINDANAO 
Zev13949 everetti CAMIGUINSUR 
Zev31650 everetti SAMAR 
Zev28451 everetti MINDANAO 
Z_HI_BRY431 japonicus HAWAII 
Z_HI_NAN290 japonicus HAWAII 
Z_HI_WAI087 japonicus HAWAII 
Z_HI_WAI078 japonicus HAWAII 
Z_HI_SOL783 japonicus HAWAII</code></pre>
</section>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<p>Begin the analysis by restarting the R session (Session/Restart R in RStudio), loading the initial package libraries, and starting a log of the analysis. Other package libraries will be loaded as needed in later blocks. The following R packages should be installed using the Tools/Install Packages feature in RStudio.</p>
<ul>
<li><p>logr (If you are interested in keeping a log of the analysis.) <span class="citation" data-cites="logr">(<a href="#ref-logr" role="doc-biblioref">Bosak 2024</a>)</span></p></li>
<li><p>vcfR <span class="citation" data-cites="vcfR">(<a href="#ref-vcfR" role="doc-biblioref">Knaus and Grünwald 2017</a>)</span></p></li>
<li><p>poppr <span class="citation" data-cites="poppr">(<a href="#ref-poppr" role="doc-biblioref">Kamvar, Tabima, and Grünwald 2014</a>)</span></p></li>
<li><p>ape <span class="citation" data-cites="ape">(<a href="#ref-ape" role="doc-biblioref">Paradis and Schliep 2019</a>)</span> <span class="citation" data-cites="paradis2004">(<a href="#ref-paradis2004" role="doc-biblioref">Paradis, Claude, and Strimmer 2004</a>)</span></p></li>
<li><p>adegenet (adgenet is automatically installed along with ape) <span class="citation" data-cites="adegenet">(<a href="#ref-adegenet" role="doc-biblioref">T. Jombart 2008</a>)</span></p></li>
<li><p>vegan <span class="citation" data-cites="vegan">(<a href="#ref-vegan" role="doc-biblioref">Oksanen et al. 2025</a>)</span></p></li>
<li><p>RcolorBrewer <span class="citation" data-cites="RColorBrewer">(<a href="#ref-RColorBrewer" role="doc-biblioref">Neuwirth 2022</a>)</span></p></li>
<li><p>popgenstuff (Not available currently in the R package repository in the RStudio drop-down list. To install go <a href="https://github.com/gbradburd/popgenstuff/">here</a>.)</p></li>
<li><p>umap <span class="citation" data-cites="umap">(<a href="#ref-umap" role="doc-biblioref">Konopka 2023</a>)</span></p></li>
<li><p>igraph <span class="citation" data-cites="igraph">(<a href="#ref-igraph" role="doc-biblioref">Csardi and Nepusz 2006</a>)</span></p></li>
<li><p>plotly <span class="citation" data-cites="plotly">(<a href="#ref-plotly" role="doc-biblioref">Sievert 2020</a>)</span></p></li>
<li><p>htmlwidgets <span class="citation" data-cites="htmlwidgets">(<a href="#ref-htmlwidgets" role="doc-biblioref">Vaidyanathan et al. 2023</a>)</span></p></li>
<li><p>ggplot2 <span class="citation" data-cites="ggplot2">(<a href="#ref-ggplot2" role="doc-biblioref">Wickham 2016</a>)</span></p></li>
<li><p>tidyr <span class="citation" data-cites="tidyr">(<a href="#ref-tidyr" role="doc-biblioref">Wickham, Vaughan, and Girlich 2024</a>)</span></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: common</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log_open</span>(<span class="at">file_name =</span> <span class="st">"ZosteropsSNPs.log"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "./log/ZosteropsSNPs.log"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcfR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
   *****       ***   vcfR   ***       *****
   This is vcfR 1.15.0 
     browseVignettes('vcfR') # Documentation
     citation('vcfR') # Citation
   *****       *****      *****       *****</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poppr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: adegenet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ade4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
   /// adegenet 2.1.10 is loaded ////////////

   &gt; overview: '?adegenet'
   &gt; tutorials/doc/questions: 'adegenetWeb()' 
   &gt; bug reports/feature requests: adegenetIssues()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'pegas':
  method      from
  print.amova ade4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is poppr version 2.9.6. To get started, type package?poppr
OMP parallel support: unavailable</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adegenet)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: permute</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(popgenstuff)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(umap)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'igraph'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vegan':

    diversity</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:permute':

    permute</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ape':

    degree, edges, mst, ring</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    decompose, spectrum</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:igraph':

    groups</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:igraph':

    crossing</code></pre>
</div>
</div>
</section>
<section id="vcf-file" class="level2">
<h2 class="anchored" data-anchor-id="vcf-file">VCF file</h2>
<p>Load the filtered VCF dataset from a compressed gzipped (<code>gz</code>) file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load SNPs from VCF file</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPs <span class="ot">&lt;-</span> <span class="fu">read.vcfR</span>(<span class="st">"Data/VCF files/zost.filtered.snps.vcf.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scanning file to determine attributes.
File attributes:
  meta lines: 14
  header_line: 15
  variant count: 15704
  column count: 133

Meta line 14 read in.
All meta lines processed.
gt matrix initialized.
Character matrix gt created.
  Character matrix gt rows: 15704
  Character matrix gt cols: 133
  skip: 0
  nrows: 15704
  row_num: 0

Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant: 15704
All variants processed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***** Object of Class vcfR *****
124 samples
239 CHROMs
15,704 variants
Object size: 166.5 Mb
5.314 percent missing data
*****        *****         *****</code></pre>
</div>
</div>
<p>Extract allelic states from the <code>ZosteropsSNPs</code> from the ‘gt’ portion of the VCF file and create a new object. Estimate Wu and Watterson’s 𝜃 <span class="citation" data-cites="watterson1975">(<a href="#ref-watterson1975" role="doc-biblioref">Watterson 1975</a>)</span> from this new object using the package <a href="https://rdrr.io/github/gbradburd/popgenstuff/man/calcThetaW.html">popgenstuff</a> (calculation includes only the polymorphic sites).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Theta W for polymorphic SNPs. Only calculating Theta W for polymorphic sites. </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPsgt <span class="ot">&lt;-</span> <span class="fu">extract.gt</span>(ZosteropsSNPs)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">calcThetaW</span>(ZosteropsSNPsgt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09198321</code></pre>
</div>
</div>
<p>Define the populations from a tab delimited (\t) text file and confirm that the sample names match those in the VCF file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define taxa and populations from tab delimited (\t) text file with a header and confirm sample names match the VCF file.</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ZosteropsPOPs <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Data/Taxon files/ZosteropsPOPS4.txt"</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">colnames</span>(ZosteropsSNPs<span class="sc">@</span>gt)[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">==</span> ZosteropsPOPs<span class="sc">$</span>SAMPLE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Convert the <code>ZosteropsSNPs</code> VCF object to a genlight (<code>gl</code>) object, indicate the ploidy (2 for diploid), and assign taxa to the genlight object using <code>ZosteropsPOPs</code> and the TAXON column (<code>ZosteropsPOPs$TAXON</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to genlight object, determine ploidy, and assign taxa to genlight object.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>gl.ZosteropsSNPs <span class="ot">&lt;-</span> <span class="fu">vcfR2genlight</span>(ZosteropsSNPs)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ploidy</span>(gl.ZosteropsSNPs) <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pop</span>(gl.ZosteropsSNPs) <span class="ot">&lt;-</span> ZosteropsPOPs<span class="sc">$</span>TAXON</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="color-settings" class="level2">
<h2 class="anchored" data-anchor-id="color-settings">Color settings</h2>
<p>Define the color schema to be used throughout the figures for each taxon.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ColorPal_CUSTOM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#004949"</span>, <span class="st">"#DB6D00"</span>, <span class="st">"#D82632"</span>, <span class="st">"#290AD8"</span>, <span class="st">"#FED439"</span>, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"#B66DFF"</span>, <span class="st">"#006DDB"</span>, <span class="st">"#FA9C88"</span>, <span class="st">"#924900"</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"#7BA9CB"</span>, <span class="st">"#008600"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="minimum-spanning-network-msn" class="level2">
<h2 class="anchored" data-anchor-id="minimum-spanning-network-msn">Minimum spanning network (MSN)</h2>
<p>Create a minimum spanning network (MSN). Export the figure as either a <code>pdf</code> or <code>png</code> file using the export function in RStudio. Beginning here we will set a different random seed for each operation where a seed is required. Setting <code>inds</code> to some set of characters not in the dataset (in this instance just a blank space) and <code>nodelab</code> to some arbitrarily large number in <code>plot_poppr_msn</code> will leave blank points on the network. Removing these arguments will result in each point on the network labeled with the corresponding sample name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>MSNseed <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>, <span class="dv">1</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(MSNseed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 661</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(MSNseed)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPsDist <span class="ot">&lt;-</span> <span class="fu">bitwise.dist</span>(gl.ZosteropsSNPs)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPsMSN <span class="ot">&lt;-</span> <span class="fu">poppr.msn</span>(gl.ZosteropsSNPs, ZosteropsSNPsDist, <span class="at">showplot =</span> <span class="cn">FALSE</span>, <span class="at">include.ties =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>node.size <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">2</span>, <span class="at">times =</span> <span class="fu">nInd</span>(gl.ZosteropsSNPs))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(node.size) <span class="ot">&lt;-</span> <span class="fu">indNames</span>(gl.ZosteropsSNPs)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vertex.attributes</span>(ZosteropsSNPsMSN<span class="sc">$</span>graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> node.size</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_poppr_msn</span>(gl.ZosteropsSNPs, ZosteropsSNPsMSN, <span class="at">palette =</span> ColorPal_CUSTOM, <span class="at">gadj =</span> <span class="dv">70</span>, <span class="at">label.cex =</span> <span class="dv">8</span>, <span class="at">pop.leg =</span> <span class="cn">TRUE</span>, <span class="at">size.leg =</span> <span class="cn">FALSE</span>, <span class="at">inds =</span> <span class="st">""</span>, <span class="at">nodelab =</span> <span class="dv">100000</span>, )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/Minimum spanning network-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distance-tree" class="level2">
<h2 class="anchored" data-anchor-id="distance-tree">Distance tree</h2>
<p>Create a distance tree based on the unweighted pair group method with arithmetic mean (UPGMA). Export the figure as either a <code>pdf</code> or <code>png</code> file using the export function in RStudio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPsDTree <span class="ot">&lt;-</span> <span class="fu">aboot</span>(gl.ZosteropsSNPs, <span class="at">tree =</span> <span class="st">"upgma"</span>, <span class="at">distance =</span> bitwise.dist, <span class="at">sample =</span> <span class="dv">100</span>, <span class="at">showtree =</span> <span class="cn">FALSE</span>, <span class="at">cutoff =</span> <span class="dv">50</span>, <span class="at">quiet =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Running bootstraps:       100 / 100
Calculating bootstrap values... done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.phylo</span>(ZosteropsSNPsDTree, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">font =</span> <span class="dv">2</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nodelabels</span>(ZosteropsSNPsDTree<span class="sc">$</span>node.label, <span class="at">adj =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.5</span>), <span class="at">frame =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">1.3</span>,<span class="at">font =</span> <span class="dv">3</span>, <span class="at">xpd =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">cex.axis =</span> <span class="dv">2</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">xlab =</span> <span class="st">"Genetic distance (proportion of loci that are different)"</span>, <span class="at">cex.lab =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/Distance tree-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="principal-component-analysis-pca" class="level2">
<h2 class="anchored" data-anchor-id="principal-component-analysis-pca">Principal component analysis (PCA)</h2>
<p>Conduct a principal component analysis (PCA) on the <code>gl.ZosteropsSNPs</code> object. Graph the percent of variance explained by each principal component (PC) and create two PC plots; one plot with PC1 and PC2 and a three-dimensional plot with PC1, PC2, and PC3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>PCAseed <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>, <span class="dv">1</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PCAseed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 135</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(PCAseed)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPsPCA <span class="ot">&lt;-</span> <span class="fu">glPca</span>(gl.ZosteropsSNPs, <span class="at">nf =</span> <span class="dv">5</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPs_PCA_VARexp <span class="ot">&lt;-</span> (<span class="dv">100</span><span class="sc">*</span>ZosteropsSNPsPCA<span class="sc">$</span>eig<span class="sc">/</span><span class="fu">sum</span>(ZosteropsSNPsPCA<span class="sc">$</span>eig))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="dv">100</span><span class="sc">*</span>ZosteropsSNPsPCA<span class="sc">$</span>eig<span class="sc">/</span><span class="fu">sum</span>(ZosteropsSNPsPCA<span class="sc">$</span>eig), <span class="at">col =</span> <span class="fu">heat.colors</span>(<span class="dv">200</span>), <span class="at">main =</span> <span class="st">"PCA Eigenvalues"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">cex.axis =</span> <span class="fl">1.4</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">ylab =</span> <span class="st">"Percent of variance explained"</span>, <span class="at">line =</span><span class="dv">2</span>, <span class="at">cex.lab =</span> <span class="fl">1.4</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">xlab =</span> <span class="st">"Eigenvalues"</span>, <span class="at">line =</span> <span class="dv">2</span>, <span class="at">cex.lab =</span> <span class="fl">1.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/Principal component analysis-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPsPCAscores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ZosteropsSNPsPCA<span class="sc">$</span>scores)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPsPCAscores<span class="sc">$</span>pop <span class="ot">&lt;-</span> <span class="fu">pop</span>(gl.ZosteropsSNPs)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>PCAplot <span class="ot">&lt;-</span> ZosteropsSNPsPCAscores</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"erythropleurus"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. erythropleurus"</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"everetti"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. everetti"</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"japonicus"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. japonicus"</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"japonicus_alani"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. japonicus alani"</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"meyeni"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. meyeni"</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"montanus_NORTH"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. montanus N. PHILIPPINES"</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"montanus_PALAWAN"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. montanus PALAWAN"</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"montanus_SOUTH"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. montanus S. PHILIPPINES"</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"nigrorum"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. nigrorum"</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"palpebrosus"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. palpebrosus"</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)[<span class="fu">levels</span>(PCAplot<span class="sc">$</span>pop)<span class="sc">==</span><span class="st">"simplex"</span>] <span class="ot">&lt;-</span> <span class="st">"Z. simplex"</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PCAplot)[<span class="fu">names</span>(PCAplot)<span class="sc">==</span><span class="st">"pop"</span>]  <span class="ot">&lt;-</span> <span class="st">"Taxon"</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>PC2Dplot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> PCAplot<span class="sc">$</span>PC1, <span class="at">y =</span> PCAplot<span class="sc">$</span>PC2, <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">'black'</span>)),</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> PCAplot<span class="sc">$</span>Taxon, </span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">colors =</span> ColorPal_CUSTOM) <span class="sc">%&gt;%</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PC1'</span>), <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PC2'</span>))</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>PC3Dplot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> PCAplot<span class="sc">$</span>PC1, <span class="at">y =</span> PCAplot<span class="sc">$</span>PC2, <span class="at">z =</span> PCAplot<span class="sc">$</span>PC3, <span class="at">type =</span> <span class="st">"scatter3d"</span>, <span class="at">mode =</span> <span class="st">'markers'</span>, </span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">'black'</span>)),</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> PCAplot<span class="sc">$</span>Taxon, </span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">colors =</span> ColorPal_CUSTOM) <span class="sc">%&gt;%</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PC1'</span>),</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PC2'</span>),</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PC3'</span>)))</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>PC2Dplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-000514d35954a457156c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-000514d35954a457156c">{"x":{"visdat":{"1d5a3f872743":["function () ","plotlyVisDat"]},"cur_data":"1d5a3f872743","attrs":{"1d5a3f872743":{"x":[-9.6374717233754925,-9.5291214859841187,-9.5109761161759767,-9.5971025326666641,-9.5627676829261539,-9.4670995093976504,-9.2678457358207389,-9.6952836355465202,-8.8593105021405041,-9.5381549889737887,-9.2882488620713275,-9.3997555730487985,-9.6293930834820216,-7.6823128465486876,-9.9241138393851074,-9.5543743968754935,-7.1952208738671883,-9.5797832546393611,-9.7198481662001281,-8.6991568812165596,-9.5381061694287528,-9.6673494380602598,-9.5124022411644251,-9.5320766427654551,-9.6543249229981765,-9.4366821264956133,-9.3833377686172756,-9.5115692046845055,-9.0371399907603234,-8.1300493057950582,-9.7698829980377226,-9.3860254144601107,-9.8017145582105982,-9.7221775706361591,-9.7800668388600496,-9.7443662300038731,-9.568880471641064,-9.6590534131678716,-9.6939361048538419,-9.678164652057367,20.403050336595054,15.73645864420164,13.602830603942797,21.263700175693224,16.251667121975675,5.8107008773700093,19.411821876345858,21.215580613459878,13.576528340009258,20.711621833781411,16.48009281104104,-7.0681390512568889,-7.3355908560573777,-7.0877694508646538,-6.0187884077604288,-7.3773828595282955,-6.1374319222164688,-5.8260815829221952,-5.4482475920020326,-6.1526391257182853,-4.248906680653656,-5.396238332081408,-6.3346468499241029,-6.2957077958292373,-4.5839754373721027,-6.2157682557803282,-5.8700241451735495,-5.8704397168449765,-5.9293579635728593,-4.9827004234899848,-3.8815425856790036,-6.0855691525114128,-5.6094347055239995,15.374668199633472,7.9973814155483769,8.199628303030968,7.5967754316808849,21.375552074850937,21.261716047280096,12.644748510937626,13.342230054911552,13.849119289860367,-5.7397657867646386,-6.208698904075054,-6.1688300437824353,-5.9272053520205201,-5.621745982277714,-5.8500108564464925,-7.1702273339751628,-7.1145446595036912,-7.2953950004491492,-6.8231908777702737,-6.9168415904966754,-6.7601763968244724,-6.5449439144273258,8.1519643995898452,7.6547941500815364,5.3205919262815007,15.120319356685672,-5.7706383720894605,14.075898477997436,15.098675206169704,13.769428120594961,19.116574902889724,21.242579158998133,21.067199937847175,21.360937358566272,13.255001673797244,21.108907697431658,21.097633110909673,19.476945839243108,21.025810084201122,20.929816201803025,20.85074596131216,-5.775113477076693,-5.4775939373069953,15.446292076325154,14.831525863384336,15.790166942959461,-8.7792200572418135,-9.5250922403532758,-7.9832535412032097,-9.7764667627472566,-9.367695276574949],"y":[1.3502361456092316,1.4599687085414454,1.3958982547514551,1.2857684285050555,1.3158122451889518,1.2988994017994597,1.5112740921656804,1.2448131405669087,1.0940447571979013,1.2868317335614028,1.2255574799330096,1.270688714506347,1.4401054384271896,0.9090491715505381,1.401843694628657,1.3752638080793,1.1362828131614933,1.319873930604422,1.3338491485103532,1.1554183354613425,1.4655120182886969,1.5064930579623568,1.5069854144581833,1.2744077026111253,1.4677754718501295,1.5669120728404671,1.470548315312199,1.4066168148777307,1.227229272355842,1.1333089204250186,1.2238885925878207,1.411954196110518,1.440318159521635,1.4564883272787512,1.4175321753905989,1.5239199737137852,1.6052886973273792,1.4396428062480726,1.3981427343004331,1.3520539570802104,11.72738577499336,8.9784958547273774,7.8825411897197268,11.840412195868829,8.8681553241162856,4.7812962955847729,10.885213575224245,11.70994192238005,7.3129802823821581,10.349131971234037,4.9521649459362562,0.96229117626193361,0.7415244521280282,0.90366980546669795,0.60952324957560911,0.65906724038202125,-0.069848103349217761,0.038938341474538875,-0.17838978371191488,-0.19763389598794545,0.49350844384566511,0.54895101039644245,0.45131091513884086,0.38531183211357978,0.54384457757590876,0.52418538535097803,-0.10193907209550805,-0.26282682823709963,-0.12792890865647946,-0.27212479379391846,0.25891315211506377,-0.033728274174838792,0.13314272080027278,-23.956671148989269,-12.643599655666991,-12.247541610890705,-11.635874544861927,11.81137609305379,11.914175209236687,-19.765826114268041,-20.526969713240405,-20.822676361455773,-0.099345203765367651,-0.20614100580704695,-0.3130352239762928,-0.18637480805077281,-0.17063559289329308,-0.22614502867227795,0.60988137901179396,1.0298038937735265,0.66221216534320171,0.7869745831867252,0.65319700590222862,0.63135164150911849,0.90559412464990907,-12.717172445020019,-12.328288232563347,-7.1775142347232501,-24.169710868024982,-0.070421782310469638,-21.897539281303093,-24.695885863594583,-21.054368829721859,11.051843119525426,12.027203660813138,11.982555178934634,11.935423848259598,7.4191185989059596,11.596350207013799,11.732737399964972,11.008886655053102,11.813465885024836,11.426444662983599,11.778904342425147,0.023427757106504056,-0.18363487660761518,-24.083095562994128,-23.367779354612562,-24.376846623350929,1.4600709157108827,1.4044014282315107,1.0042176839773636,1.5493541299761322,1.3001422997188825],"mode":"markers","marker":{"size":10,"line":{"width":1,"color":"black"}},"color":["Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus PALAWAN","Z. montanus PALAWAN","Z. nigrorum","Z. erythropleurus","Z. erythropleurus","Z. erythropleurus","Z. simplex","Z. simplex","Z. palpebrosus","Z. palpebrosus","Z. palpebrosus","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. erythropleurus","Z. erythropleurus","Z. erythropleurus","Z. nigrorum","Z. nigrorum","Z. nigrorum","Z. nigrorum","Z. palpebrosus","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. everetti","Z. everetti","Z. everetti","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus"],"colors":["#004949","#DB6D00","#D82632","#290AD8","#FED439","#B66DFF","#006DDB","#FA9C88","#924900","#7BA9CB","#008600"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"PC1"},"yaxis":{"domain":[0,1],"automargin":true,"title":"PC2"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[7.9973814155483769,8.199628303030968,7.5967754316808849,8.1519643995898452,7.6547941500815364,5.3205919262815007],"y":[-12.643599655666991,-12.247541610890705,-11.635874544861927,-12.717172445020019,-12.328288232563347,-7.1775142347232501],"mode":"markers","marker":{"color":"rgba(0,73,73,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. erythropleurus","textfont":{"color":"rgba(0,73,73,1)"},"error_y":{"color":"rgba(0,73,73,1)"},"error_x":{"color":"rgba(0,73,73,1)"},"line":{"color":"rgba(0,73,73,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[15.446292076325154,14.831525863384336,15.790166942959461],"y":[-24.083095562994128,-23.367779354612562,-24.376846623350929],"mode":"markers","marker":{"color":"rgba(219,109,0,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. everetti","textfont":{"color":"rgba(219,109,0,1)"},"error_y":{"color":"rgba(219,109,0,1)"},"error_x":{"color":"rgba(219,109,0,1)"},"line":{"color":"rgba(219,109,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-9.6374717233754925,-9.5291214859841187,-9.5109761161759767,-9.5971025326666641,-9.5627676829261539,-9.4670995093976504,-9.2678457358207389,-9.6952836355465202,-8.8593105021405041,-9.5381549889737887,-9.2882488620713275,-9.3997555730487985,-9.6293930834820216,-7.6823128465486876,-9.9241138393851074,-9.5543743968754935,-7.1952208738671883,-9.5797832546393611,-9.7198481662001281,-8.6991568812165596,-9.5381061694287528,-9.6673494380602598,-9.5124022411644251,-9.5320766427654551,-9.6543249229981765,-9.8017145582105982,-9.7221775706361591,-9.7800668388600496,-9.7443662300038731,-9.568880471641064,-9.6590534131678716,-9.6939361048538419,-9.678164652057367,-8.7792200572418135,-9.5250922403532758,-7.9832535412032097,-9.7764667627472566,-9.367695276574949],"y":[1.3502361456092316,1.4599687085414454,1.3958982547514551,1.2857684285050555,1.3158122451889518,1.2988994017994597,1.5112740921656804,1.2448131405669087,1.0940447571979013,1.2868317335614028,1.2255574799330096,1.270688714506347,1.4401054384271896,0.9090491715505381,1.401843694628657,1.3752638080793,1.1362828131614933,1.319873930604422,1.3338491485103532,1.1554183354613425,1.4655120182886969,1.5064930579623568,1.5069854144581833,1.2744077026111253,1.4677754718501295,1.440318159521635,1.4564883272787512,1.4175321753905989,1.5239199737137852,1.6052886973273792,1.4396428062480726,1.3981427343004331,1.3520539570802104,1.4600709157108827,1.4044014282315107,1.0042176839773636,1.5493541299761322,1.3001422997188825],"mode":"markers","marker":{"color":"rgba(216,38,50,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. japonicus","textfont":{"color":"rgba(216,38,50,1)"},"error_y":{"color":"rgba(216,38,50,1)"},"error_x":{"color":"rgba(216,38,50,1)"},"line":{"color":"rgba(216,38,50,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-9.4366821264956133,-9.3833377686172756,-9.5115692046845055,-9.0371399907603234,-8.1300493057950582,-9.7698829980377226,-9.3860254144601107],"y":[1.5669120728404671,1.470548315312199,1.4066168148777307,1.227229272355842,1.1333089204250186,1.2238885925878207,1.411954196110518],"mode":"markers","marker":{"color":"rgba(41,10,216,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. japonicus alani","textfont":{"color":"rgba(41,10,216,1)"},"error_y":{"color":"rgba(41,10,216,1)"},"error_x":{"color":"rgba(41,10,216,1)"},"line":{"color":"rgba(41,10,216,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-7.0681390512568889,-7.3355908560573777,-7.0877694508646538,-6.0187884077604288,-7.3773828595282955,-7.1702273339751628,-7.1145446595036912,-7.2953950004491492,-6.8231908777702737,-6.9168415904966754,-6.7601763968244724,-6.5449439144273258],"y":[0.96229117626193361,0.7415244521280282,0.90366980546669795,0.60952324957560911,0.65906724038202125,0.60988137901179396,1.0298038937735265,0.66221216534320171,0.7869745831867252,0.65319700590222862,0.63135164150911849,0.90559412464990907],"mode":"markers","marker":{"color":"rgba(254,212,57,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. meyeni","textfont":{"color":"rgba(254,212,57,1)"},"error_y":{"color":"rgba(254,212,57,1)"},"error_x":{"color":"rgba(254,212,57,1)"},"line":{"color":"rgba(254,212,57,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-4.248906680653656,-5.396238332081408,-6.3346468499241029,-6.2957077958292373,-4.5839754373721027,-6.2157682557803282],"y":[0.49350844384566511,0.54895101039644245,0.45131091513884086,0.38531183211357978,0.54384457757590876,0.52418538535097803],"mode":"markers","marker":{"color":"rgba(182,109,255,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. montanus N. PHILIPPINES","textfont":{"color":"rgba(182,109,255,1)"},"error_y":{"color":"rgba(182,109,255,1)"},"error_x":{"color":"rgba(182,109,255,1)"},"line":{"color":"rgba(182,109,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-6.0855691525114128,-5.6094347055239995],"y":[-0.033728274174838792,0.13314272080027278],"mode":"markers","marker":{"color":"rgba(0,109,219,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. montanus PALAWAN","textfont":{"color":"rgba(0,109,219,1)"},"error_y":{"color":"rgba(0,109,219,1)"},"error_x":{"color":"rgba(0,109,219,1)"},"line":{"color":"rgba(0,109,219,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-6.1374319222164688,-5.8260815829221952,-5.4482475920020326,-6.1526391257182853,-5.8700241451735495,-5.8704397168449765,-5.9293579635728593,-4.9827004234899848,-3.8815425856790036,-5.7397657867646386,-6.208698904075054,-6.1688300437824353,-5.9272053520205201,-5.621745982277714,-5.8500108564464925,-5.775113477076693,-5.4775939373069953],"y":[-0.069848103349217761,0.038938341474538875,-0.17838978371191488,-0.19763389598794545,-0.10193907209550805,-0.26282682823709963,-0.12792890865647946,-0.27212479379391846,0.25891315211506377,-0.099345203765367651,-0.20614100580704695,-0.3130352239762928,-0.18637480805077281,-0.17063559289329308,-0.22614502867227795,0.023427757106504056,-0.18363487660761518],"mode":"markers","marker":{"color":"rgba(250,156,136,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. montanus S. PHILIPPINES","textfont":{"color":"rgba(250,156,136,1)"},"error_y":{"color":"rgba(250,156,136,1)"},"error_x":{"color":"rgba(250,156,136,1)"},"line":{"color":"rgba(250,156,136,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[15.374668199633472,15.120319356685672,-5.7706383720894605,14.075898477997436,15.098675206169704],"y":[-23.956671148989269,-24.169710868024982,-0.070421782310469638,-21.897539281303093,-24.695885863594583],"mode":"markers","marker":{"color":"rgba(146,73,0,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. nigrorum","textfont":{"color":"rgba(146,73,0,1)"},"error_y":{"color":"rgba(146,73,0,1)"},"error_x":{"color":"rgba(146,73,0,1)"},"line":{"color":"rgba(146,73,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[12.644748510937626,13.342230054911552,13.849119289860367,13.769428120594961],"y":[-19.765826114268041,-20.526969713240405,-20.822676361455773,-21.054368829721859],"mode":"markers","marker":{"color":"rgba(123,169,203,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. palpebrosus","textfont":{"color":"rgba(123,169,203,1)"},"error_y":{"color":"rgba(123,169,203,1)"},"error_x":{"color":"rgba(123,169,203,1)"},"line":{"color":"rgba(123,169,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[20.403050336595054,15.73645864420164,13.602830603942797,21.263700175693224,16.251667121975675,5.8107008773700093,19.411821876345858,21.215580613459878,13.576528340009258,20.711621833781411,16.48009281104104,21.375552074850937,21.261716047280096,19.116574902889724,21.242579158998133,21.067199937847175,21.360937358566272,13.255001673797244,21.108907697431658,21.097633110909673,19.476945839243108,21.025810084201122,20.929816201803025,20.85074596131216],"y":[11.72738577499336,8.9784958547273774,7.8825411897197268,11.840412195868829,8.8681553241162856,4.7812962955847729,10.885213575224245,11.70994192238005,7.3129802823821581,10.349131971234037,4.9521649459362562,11.81137609305379,11.914175209236687,11.051843119525426,12.027203660813138,11.982555178934634,11.935423848259598,7.4191185989059596,11.596350207013799,11.732737399964972,11.008886655053102,11.813465885024836,11.426444662983599,11.778904342425147],"mode":"markers","marker":{"color":"rgba(0,134,0,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter","name":"Z. simplex","textfont":{"color":"rgba(0,134,0,1)"},"error_y":{"color":"rgba(0,134,0,1)"},"error_x":{"color":"rgba(0,134,0,1)"},"line":{"color":"rgba(0,134,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>PC3Dplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-cbc4c6346889ee032bdb" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-cbc4c6346889ee032bdb">{"x":{"visdat":{"1d5a4222c04a":["function () ","plotlyVisDat"]},"cur_data":"1d5a4222c04a","attrs":{"1d5a4222c04a":{"x":[-9.6374717233754925,-9.5291214859841187,-9.5109761161759767,-9.5971025326666641,-9.5627676829261539,-9.4670995093976504,-9.2678457358207389,-9.6952836355465202,-8.8593105021405041,-9.5381549889737887,-9.2882488620713275,-9.3997555730487985,-9.6293930834820216,-7.6823128465486876,-9.9241138393851074,-9.5543743968754935,-7.1952208738671883,-9.5797832546393611,-9.7198481662001281,-8.6991568812165596,-9.5381061694287528,-9.6673494380602598,-9.5124022411644251,-9.5320766427654551,-9.6543249229981765,-9.4366821264956133,-9.3833377686172756,-9.5115692046845055,-9.0371399907603234,-8.1300493057950582,-9.7698829980377226,-9.3860254144601107,-9.8017145582105982,-9.7221775706361591,-9.7800668388600496,-9.7443662300038731,-9.568880471641064,-9.6590534131678716,-9.6939361048538419,-9.678164652057367,20.403050336595054,15.73645864420164,13.602830603942797,21.263700175693224,16.251667121975675,5.8107008773700093,19.411821876345858,21.215580613459878,13.576528340009258,20.711621833781411,16.48009281104104,-7.0681390512568889,-7.3355908560573777,-7.0877694508646538,-6.0187884077604288,-7.3773828595282955,-6.1374319222164688,-5.8260815829221952,-5.4482475920020326,-6.1526391257182853,-4.248906680653656,-5.396238332081408,-6.3346468499241029,-6.2957077958292373,-4.5839754373721027,-6.2157682557803282,-5.8700241451735495,-5.8704397168449765,-5.9293579635728593,-4.9827004234899848,-3.8815425856790036,-6.0855691525114128,-5.6094347055239995,15.374668199633472,7.9973814155483769,8.199628303030968,7.5967754316808849,21.375552074850937,21.261716047280096,12.644748510937626,13.342230054911552,13.849119289860367,-5.7397657867646386,-6.208698904075054,-6.1688300437824353,-5.9272053520205201,-5.621745982277714,-5.8500108564464925,-7.1702273339751628,-7.1145446595036912,-7.2953950004491492,-6.8231908777702737,-6.9168415904966754,-6.7601763968244724,-6.5449439144273258,8.1519643995898452,7.6547941500815364,5.3205919262815007,15.120319356685672,-5.7706383720894605,14.075898477997436,15.098675206169704,13.769428120594961,19.116574902889724,21.242579158998133,21.067199937847175,21.360937358566272,13.255001673797244,21.108907697431658,21.097633110909673,19.476945839243108,21.025810084201122,20.929816201803025,20.85074596131216,-5.775113477076693,-5.4775939373069953,15.446292076325154,14.831525863384336,15.790166942959461,-8.7792200572418135,-9.5250922403532758,-7.9832535412032097,-9.7764667627472566,-9.367695276574949],"y":[1.3502361456092316,1.4599687085414454,1.3958982547514551,1.2857684285050555,1.3158122451889518,1.2988994017994597,1.5112740921656804,1.2448131405669087,1.0940447571979013,1.2868317335614028,1.2255574799330096,1.270688714506347,1.4401054384271896,0.9090491715505381,1.401843694628657,1.3752638080793,1.1362828131614933,1.319873930604422,1.3338491485103532,1.1554183354613425,1.4655120182886969,1.5064930579623568,1.5069854144581833,1.2744077026111253,1.4677754718501295,1.5669120728404671,1.470548315312199,1.4066168148777307,1.227229272355842,1.1333089204250186,1.2238885925878207,1.411954196110518,1.440318159521635,1.4564883272787512,1.4175321753905989,1.5239199737137852,1.6052886973273792,1.4396428062480726,1.3981427343004331,1.3520539570802104,11.72738577499336,8.9784958547273774,7.8825411897197268,11.840412195868829,8.8681553241162856,4.7812962955847729,10.885213575224245,11.70994192238005,7.3129802823821581,10.349131971234037,4.9521649459362562,0.96229117626193361,0.7415244521280282,0.90366980546669795,0.60952324957560911,0.65906724038202125,-0.069848103349217761,0.038938341474538875,-0.17838978371191488,-0.19763389598794545,0.49350844384566511,0.54895101039644245,0.45131091513884086,0.38531183211357978,0.54384457757590876,0.52418538535097803,-0.10193907209550805,-0.26282682823709963,-0.12792890865647946,-0.27212479379391846,0.25891315211506377,-0.033728274174838792,0.13314272080027278,-23.956671148989269,-12.643599655666991,-12.247541610890705,-11.635874544861927,11.81137609305379,11.914175209236687,-19.765826114268041,-20.526969713240405,-20.822676361455773,-0.099345203765367651,-0.20614100580704695,-0.3130352239762928,-0.18637480805077281,-0.17063559289329308,-0.22614502867227795,0.60988137901179396,1.0298038937735265,0.66221216534320171,0.7869745831867252,0.65319700590222862,0.63135164150911849,0.90559412464990907,-12.717172445020019,-12.328288232563347,-7.1775142347232501,-24.169710868024982,-0.070421782310469638,-21.897539281303093,-24.695885863594583,-21.054368829721859,11.051843119525426,12.027203660813138,11.982555178934634,11.935423848259598,7.4191185989059596,11.596350207013799,11.732737399964972,11.008886655053102,11.813465885024836,11.426444662983599,11.778904342425147,0.023427757106504056,-0.18363487660761518,-24.083095562994128,-23.367779354612562,-24.376846623350929,1.4600709157108827,1.4044014282315107,1.0042176839773636,1.5493541299761322,1.3001422997188825],"z":[-1.2084210987598811,-1.1050792002108241,-1.0789187511534202,-1.0271909109403237,-1.0525471298240858,-1.0942222004473121,-1.0312274192855142,-1.0820846907397661,-1.0435616050374588,-1.0821630012389705,-1.1210902993252114,-1.0938538469819696,-1.0473098098295521,-0.8066718828942302,-1.2032996734991561,-1.162432300365168,-0.90363299921729001,-1.0848798411893068,-1.0769415745918101,-1.0562259639100915,-1.0576649939436202,-1.1547334632204485,-1.0976955893476241,-0.98740761840343694,-1.1509291179094372,-1.0172880461546165,-0.97681587977334472,-1.0077423312353635,-1.0179963064510982,-0.82873584714552984,-0.9940227374840227,-0.86042168882001369,-1.2080588230630744,-1.1404924740559343,-1.193862074534076,-1.1571330496826413,-1.1067881633977716,-1.0800711060699475,-1.1749568378582709,-1.1607909259829434,-0.48665741696475173,-0.29936818313913999,-0.38929371753410802,-0.47077493689562094,-0.176021983162058,-0.14656585133479166,-0.5888743229927601,-0.47661835372781913,-0.44287717068318944,-0.63443556549113556,0.10003865137534608,0.21907022958163508,0.18706677232016294,0.46328821067668391,0.18693603013370741,0.39584160339825075,1.0475120720056093,1.0960374076264285,0.8293424397639364,1.1784189970020413,0.14704978442406785,0.085179709827792563,0.67538569977480001,0.35082736397445707,0.48359259935854282,0.53184865890097233,1.0734010747564546,1.0081512112754105,1.2742296150319397,1.0929737333452358,0.89728373607862055,1.0515562160895677,1.0262960252871018,-15.393071670350977,8.6510851759119589,8.3931729507889248,8.3481244394036729,-0.44784564056564652,-0.36238093570136015,22.411657517550754,22.786285258628197,23.213542058958168,1.4430396389751727,1.503810067459268,1.3972136174458916,1.4738864613368945,1.3606046003142198,1.4088701472405754,0.33691652525319993,0.29438581007797737,0.21825708899989105,0.15145976573306977,0.46050069724590947,0.21811339922605158,0.25178498088644069,8.8206607938662742,8.6218759368605511,5.0203252590743084,-16.500574193441828,1.0547483748903173,-14.488067946544666,-15.840448352350222,23.666590957571394,-0.45229023934166168,-0.55400143784581179,-0.57972873425712579,-0.65944750848002531,-0.16621353094196092,-0.48251131820183019,-0.32362213163112374,-0.45824614714384643,-0.68929836089632024,-0.50014071580258124,-0.78144923994277993,1.3532700968542677,0.96294163716620951,-16.230270445718659,-16.119825552949603,-16.096040858677423,-0.92892016907167829,-1.0780560080299382,-0.92041013880989186,-1.1486600863277034,-1.1760809608050562],"mode":"markers","marker":{"size":10,"line":{"width":1,"color":"black"}},"color":["Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus alani","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus N. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus PALAWAN","Z. montanus PALAWAN","Z. nigrorum","Z. erythropleurus","Z. erythropleurus","Z. erythropleurus","Z. simplex","Z. simplex","Z. palpebrosus","Z. palpebrosus","Z. palpebrosus","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. meyeni","Z. erythropleurus","Z. erythropleurus","Z. erythropleurus","Z. nigrorum","Z. nigrorum","Z. nigrorum","Z. nigrorum","Z. palpebrosus","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. simplex","Z. montanus S. PHILIPPINES","Z. montanus S. PHILIPPINES","Z. everetti","Z. everetti","Z. everetti","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus","Z. japonicus"],"colors":["#004949","#DB6D00","#D82632","#290AD8","#FED439","#B66DFF","#006DDB","#FA9C88","#924900","#7BA9CB","#008600"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[7.9973814155483769,8.199628303030968,7.5967754316808849,8.1519643995898452,7.6547941500815364,5.3205919262815007],"y":[-12.643599655666991,-12.247541610890705,-11.635874544861927,-12.717172445020019,-12.328288232563347,-7.1775142347232501],"z":[8.6510851759119589,8.3931729507889248,8.3481244394036729,8.8206607938662742,8.6218759368605511,5.0203252590743084],"mode":"markers","marker":{"color":"rgba(0,73,73,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. erythropleurus","textfont":{"color":"rgba(0,73,73,1)"},"error_y":{"color":"rgba(0,73,73,1)"},"error_x":{"color":"rgba(0,73,73,1)"},"line":{"color":"rgba(0,73,73,1)"},"frame":null},{"x":[15.446292076325154,14.831525863384336,15.790166942959461],"y":[-24.083095562994128,-23.367779354612562,-24.376846623350929],"z":[-16.230270445718659,-16.119825552949603,-16.096040858677423],"mode":"markers","marker":{"color":"rgba(219,109,0,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. everetti","textfont":{"color":"rgba(219,109,0,1)"},"error_y":{"color":"rgba(219,109,0,1)"},"error_x":{"color":"rgba(219,109,0,1)"},"line":{"color":"rgba(219,109,0,1)"},"frame":null},{"x":[-9.6374717233754925,-9.5291214859841187,-9.5109761161759767,-9.5971025326666641,-9.5627676829261539,-9.4670995093976504,-9.2678457358207389,-9.6952836355465202,-8.8593105021405041,-9.5381549889737887,-9.2882488620713275,-9.3997555730487985,-9.6293930834820216,-7.6823128465486876,-9.9241138393851074,-9.5543743968754935,-7.1952208738671883,-9.5797832546393611,-9.7198481662001281,-8.6991568812165596,-9.5381061694287528,-9.6673494380602598,-9.5124022411644251,-9.5320766427654551,-9.6543249229981765,-9.8017145582105982,-9.7221775706361591,-9.7800668388600496,-9.7443662300038731,-9.568880471641064,-9.6590534131678716,-9.6939361048538419,-9.678164652057367,-8.7792200572418135,-9.5250922403532758,-7.9832535412032097,-9.7764667627472566,-9.367695276574949],"y":[1.3502361456092316,1.4599687085414454,1.3958982547514551,1.2857684285050555,1.3158122451889518,1.2988994017994597,1.5112740921656804,1.2448131405669087,1.0940447571979013,1.2868317335614028,1.2255574799330096,1.270688714506347,1.4401054384271896,0.9090491715505381,1.401843694628657,1.3752638080793,1.1362828131614933,1.319873930604422,1.3338491485103532,1.1554183354613425,1.4655120182886969,1.5064930579623568,1.5069854144581833,1.2744077026111253,1.4677754718501295,1.440318159521635,1.4564883272787512,1.4175321753905989,1.5239199737137852,1.6052886973273792,1.4396428062480726,1.3981427343004331,1.3520539570802104,1.4600709157108827,1.4044014282315107,1.0042176839773636,1.5493541299761322,1.3001422997188825],"z":[-1.2084210987598811,-1.1050792002108241,-1.0789187511534202,-1.0271909109403237,-1.0525471298240858,-1.0942222004473121,-1.0312274192855142,-1.0820846907397661,-1.0435616050374588,-1.0821630012389705,-1.1210902993252114,-1.0938538469819696,-1.0473098098295521,-0.8066718828942302,-1.2032996734991561,-1.162432300365168,-0.90363299921729001,-1.0848798411893068,-1.0769415745918101,-1.0562259639100915,-1.0576649939436202,-1.1547334632204485,-1.0976955893476241,-0.98740761840343694,-1.1509291179094372,-1.2080588230630744,-1.1404924740559343,-1.193862074534076,-1.1571330496826413,-1.1067881633977716,-1.0800711060699475,-1.1749568378582709,-1.1607909259829434,-0.92892016907167829,-1.0780560080299382,-0.92041013880989186,-1.1486600863277034,-1.1760809608050562],"mode":"markers","marker":{"color":"rgba(216,38,50,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. japonicus","textfont":{"color":"rgba(216,38,50,1)"},"error_y":{"color":"rgba(216,38,50,1)"},"error_x":{"color":"rgba(216,38,50,1)"},"line":{"color":"rgba(216,38,50,1)"},"frame":null},{"x":[-9.4366821264956133,-9.3833377686172756,-9.5115692046845055,-9.0371399907603234,-8.1300493057950582,-9.7698829980377226,-9.3860254144601107],"y":[1.5669120728404671,1.470548315312199,1.4066168148777307,1.227229272355842,1.1333089204250186,1.2238885925878207,1.411954196110518],"z":[-1.0172880461546165,-0.97681587977334472,-1.0077423312353635,-1.0179963064510982,-0.82873584714552984,-0.9940227374840227,-0.86042168882001369],"mode":"markers","marker":{"color":"rgba(41,10,216,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. japonicus alani","textfont":{"color":"rgba(41,10,216,1)"},"error_y":{"color":"rgba(41,10,216,1)"},"error_x":{"color":"rgba(41,10,216,1)"},"line":{"color":"rgba(41,10,216,1)"},"frame":null},{"x":[-7.0681390512568889,-7.3355908560573777,-7.0877694508646538,-6.0187884077604288,-7.3773828595282955,-7.1702273339751628,-7.1145446595036912,-7.2953950004491492,-6.8231908777702737,-6.9168415904966754,-6.7601763968244724,-6.5449439144273258],"y":[0.96229117626193361,0.7415244521280282,0.90366980546669795,0.60952324957560911,0.65906724038202125,0.60988137901179396,1.0298038937735265,0.66221216534320171,0.7869745831867252,0.65319700590222862,0.63135164150911849,0.90559412464990907],"z":[0.21907022958163508,0.18706677232016294,0.46328821067668391,0.18693603013370741,0.39584160339825075,0.33691652525319993,0.29438581007797737,0.21825708899989105,0.15145976573306977,0.46050069724590947,0.21811339922605158,0.25178498088644069],"mode":"markers","marker":{"color":"rgba(254,212,57,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. meyeni","textfont":{"color":"rgba(254,212,57,1)"},"error_y":{"color":"rgba(254,212,57,1)"},"error_x":{"color":"rgba(254,212,57,1)"},"line":{"color":"rgba(254,212,57,1)"},"frame":null},{"x":[-4.248906680653656,-5.396238332081408,-6.3346468499241029,-6.2957077958292373,-4.5839754373721027,-6.2157682557803282],"y":[0.49350844384566511,0.54895101039644245,0.45131091513884086,0.38531183211357978,0.54384457757590876,0.52418538535097803],"z":[0.14704978442406785,0.085179709827792563,0.67538569977480001,0.35082736397445707,0.48359259935854282,0.53184865890097233],"mode":"markers","marker":{"color":"rgba(182,109,255,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. montanus N. PHILIPPINES","textfont":{"color":"rgba(182,109,255,1)"},"error_y":{"color":"rgba(182,109,255,1)"},"error_x":{"color":"rgba(182,109,255,1)"},"line":{"color":"rgba(182,109,255,1)"},"frame":null},{"x":[-6.0855691525114128,-5.6094347055239995],"y":[-0.033728274174838792,0.13314272080027278],"z":[1.0515562160895677,1.0262960252871018],"mode":"markers","marker":{"color":"rgba(0,109,219,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. montanus PALAWAN","textfont":{"color":"rgba(0,109,219,1)"},"error_y":{"color":"rgba(0,109,219,1)"},"error_x":{"color":"rgba(0,109,219,1)"},"line":{"color":"rgba(0,109,219,1)"},"frame":null},{"x":[-6.1374319222164688,-5.8260815829221952,-5.4482475920020326,-6.1526391257182853,-5.8700241451735495,-5.8704397168449765,-5.9293579635728593,-4.9827004234899848,-3.8815425856790036,-5.7397657867646386,-6.208698904075054,-6.1688300437824353,-5.9272053520205201,-5.621745982277714,-5.8500108564464925,-5.775113477076693,-5.4775939373069953],"y":[-0.069848103349217761,0.038938341474538875,-0.17838978371191488,-0.19763389598794545,-0.10193907209550805,-0.26282682823709963,-0.12792890865647946,-0.27212479379391846,0.25891315211506377,-0.099345203765367651,-0.20614100580704695,-0.3130352239762928,-0.18637480805077281,-0.17063559289329308,-0.22614502867227795,0.023427757106504056,-0.18363487660761518],"z":[1.0475120720056093,1.0960374076264285,0.8293424397639364,1.1784189970020413,1.0734010747564546,1.0081512112754105,1.2742296150319397,1.0929737333452358,0.89728373607862055,1.4430396389751727,1.503810067459268,1.3972136174458916,1.4738864613368945,1.3606046003142198,1.4088701472405754,1.3532700968542677,0.96294163716620951],"mode":"markers","marker":{"color":"rgba(250,156,136,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. montanus S. PHILIPPINES","textfont":{"color":"rgba(250,156,136,1)"},"error_y":{"color":"rgba(250,156,136,1)"},"error_x":{"color":"rgba(250,156,136,1)"},"line":{"color":"rgba(250,156,136,1)"},"frame":null},{"x":[15.374668199633472,15.120319356685672,-5.7706383720894605,14.075898477997436,15.098675206169704],"y":[-23.956671148989269,-24.169710868024982,-0.070421782310469638,-21.897539281303093,-24.695885863594583],"z":[-15.393071670350977,-16.500574193441828,1.0547483748903173,-14.488067946544666,-15.840448352350222],"mode":"markers","marker":{"color":"rgba(146,73,0,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. nigrorum","textfont":{"color":"rgba(146,73,0,1)"},"error_y":{"color":"rgba(146,73,0,1)"},"error_x":{"color":"rgba(146,73,0,1)"},"line":{"color":"rgba(146,73,0,1)"},"frame":null},{"x":[12.644748510937626,13.342230054911552,13.849119289860367,13.769428120594961],"y":[-19.765826114268041,-20.526969713240405,-20.822676361455773,-21.054368829721859],"z":[22.411657517550754,22.786285258628197,23.213542058958168,23.666590957571394],"mode":"markers","marker":{"color":"rgba(123,169,203,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. palpebrosus","textfont":{"color":"rgba(123,169,203,1)"},"error_y":{"color":"rgba(123,169,203,1)"},"error_x":{"color":"rgba(123,169,203,1)"},"line":{"color":"rgba(123,169,203,1)"},"frame":null},{"x":[20.403050336595054,15.73645864420164,13.602830603942797,21.263700175693224,16.251667121975675,5.8107008773700093,19.411821876345858,21.215580613459878,13.576528340009258,20.711621833781411,16.48009281104104,21.375552074850937,21.261716047280096,19.116574902889724,21.242579158998133,21.067199937847175,21.360937358566272,13.255001673797244,21.108907697431658,21.097633110909673,19.476945839243108,21.025810084201122,20.929816201803025,20.85074596131216],"y":[11.72738577499336,8.9784958547273774,7.8825411897197268,11.840412195868829,8.8681553241162856,4.7812962955847729,10.885213575224245,11.70994192238005,7.3129802823821581,10.349131971234037,4.9521649459362562,11.81137609305379,11.914175209236687,11.051843119525426,12.027203660813138,11.982555178934634,11.935423848259598,7.4191185989059596,11.596350207013799,11.732737399964972,11.008886655053102,11.813465885024836,11.426444662983599,11.778904342425147],"z":[-0.48665741696475173,-0.29936818313913999,-0.38929371753410802,-0.47077493689562094,-0.176021983162058,-0.14656585133479166,-0.5888743229927601,-0.47661835372781913,-0.44287717068318944,-0.63443556549113556,0.10003865137534608,-0.44784564056564652,-0.36238093570136015,-0.45229023934166168,-0.55400143784581179,-0.57972873425712579,-0.65944750848002531,-0.16621353094196092,-0.48251131820183019,-0.32362213163112374,-0.45824614714384643,-0.68929836089632024,-0.50014071580258124,-0.78144923994277993],"mode":"markers","marker":{"color":"rgba(0,134,0,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"Z. simplex","textfont":{"color":"rgba(0,134,0,1)"},"error_y":{"color":"rgba(0,134,0,1)"},"error_x":{"color":"rgba(0,134,0,1)"},"line":{"color":"rgba(0,134,0,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPs_PCA_VARexp[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29.581302 16.282986  7.692618  6.388801  5.459259</code></pre>
</div>
</div>
<p>Calculate the centroids for each group based on the first three principal components and the pairwise Euclidean distances between each pair of groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>Zosterops_PCAscores <span class="ot">&lt;-</span> ZosteropsSNPsPCA<span class="sc">$</span>scores[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>Zosterops_PCAgroups <span class="ot">&lt;-</span> gl.ZosteropsSNPs<span class="sc">@</span>pop</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>Zosterops_PCAdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Zosterops_PCAscores, <span class="at">Group =</span> Zosterops_PCAgroups)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>Zosterops_unique_PCAgroups <span class="ot">&lt;-</span> <span class="fu">unique</span>(Zosterops_PCAgroups)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>Zosterops_PCAcentroids <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Group =</span> <span class="fu">character</span>(), <span class="at">PC1 =</span> <span class="fu">numeric</span>(), <span class="at">PC2 =</span> <span class="fu">numeric</span>(), <span class="at">PC3 =</span> <span class="fu">numeric</span>(), <span class="at">PC4 =</span> <span class="fu">numeric</span>(), <span class="at">PC5 =</span> <span class="fu">numeric</span>(), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each unique group to calculate centroids</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (group <span class="cf">in</span> Zosterops_unique_PCAgroups) {</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  group_scores <span class="ot">&lt;-</span> Zosterops_PCAdf[Zosterops_PCAdf<span class="sc">$</span>Group <span class="sc">==</span> group, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  centroid <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(group_scores, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  Zosterops_PCAcentroids <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Zosterops_PCAcentroids, </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">data.frame</span>(<span class="at">Group =</span> group, </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">PC1 =</span> centroid[<span class="dv">1</span>], </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">PC2 =</span> centroid[<span class="dv">2</span>], </span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">PC3 =</span> centroid[<span class="dv">3</span>]))</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Zosterops_PCAcentroids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Group       PC1          PC2         PC3
PC1          japonicus -9.376887   1.35221648  -1.0864333
PC11   japonicus_alani -9.236384   1.34863688  -0.9575747
PC12           simplex 18.651395  10.28275851  -0.4361927
PC13            meyeni -6.959416   0.76292423   0.2819684
PC14    montanus_SOUTH -5.698084  -0.13380729   1.2000580
PC15    montanus_NORTH -5.512541   0.49118536   0.3789806
PC16  montanus_PALAWAN -5.847502   0.04970722   1.0389261
PC17          nigrorum 10.779785 -18.95804579 -12.2334828
PC18    erythropleurus  7.486856 -11.45833179   7.9758741
PC19       palpebrosus 13.401381 -20.54246025  23.0195189
PC110         everetti 15.355995 -23.94257385 -16.1487123</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the Euclidean distances between centroids</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>Zosterops_PCAdistance_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(Zosterops_PCAcentroids[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>Zosterops_PCAdistance_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Zosterops_PCAdistance_matrix)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Zosterops_PCAdistance_df) <span class="ot">&lt;-</span> Zosterops_PCAcentroids<span class="sc">$</span>Group</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Zosterops_PCAdistance_df) <span class="ot">&lt;-</span> Zosterops_PCAcentroids<span class="sc">$</span>Group</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Zosterops_PCAdistance_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  japonicus japonicus_alani  simplex    meyeni montanus_SOUTH
japonicus         0.0000000       0.1906787 29.42383  2.839710      4.5792900
japonicus_alani   0.1906787       0.0000000 29.28854  2.657839      4.4014299
simplex          29.4238329      29.2885398  0.00000 27.332337     26.5344922
meyeni            2.8397101       2.6578393 27.33234  0.000000      1.7994371
montanus_SOUTH    4.5792900       4.4014299 26.53449  1.799437      0.0000000
montanus_NORTH    4.2216090       4.0482851 26.08515  1.475365      1.0484323
montanus_PALAWAN  4.3209072       4.1421920 26.59111  1.522503      0.2862984
nigrorum         30.7091982      30.6619383 32.49866 29.329719     28.3959879
erythropleurus   23.0352203      22.8799410 25.84734 20.426699     18.6547362
palpebrosus      39.7407008      39.5801664 39.08871 37.222005     35.4597177
everetti         38.4501508      38.4083467 37.80365 37.125550     36.2092729
                 montanus_NORTH montanus_PALAWAN  nigrorum erythropleurus
japonicus             4.2216090        4.3209072 30.709198       23.03522
japonicus_alani       4.0482851        4.1421920 30.661938       22.87994
simplex              26.0851525       26.5911123 32.498661       25.84734
meyeni                1.4753649        1.5225032 29.329719       20.42670
montanus_SOUTH        1.0484323        0.2862984 28.395988       18.65474
montanus_NORTH        0.0000000        0.8617599 28.333490       19.22207
montanus_PALAWAN      0.8617599        0.0000000 28.529251       18.93043
nigrorum             28.3334905       28.5292511  0.000000       21.80613
erythropleurus       19.2220722       18.9304334 21.806127        0.00000
palpebrosus          36.2318185       35.7449764 35.385834       18.54223
everetti             36.1340421       36.3405111  7.817688       28.28030
                 palpebrosus  everetti
japonicus           39.74070 38.450151
japonicus_alani     39.58017 38.408347
simplex             39.08871 37.803655
meyeni              37.22201 37.125550
montanus_SOUTH      35.45972 36.209273
montanus_NORTH      36.23182 36.134042
montanus_PALAWAN    35.74498 36.340511
nigrorum            35.38583  7.817688
erythropleurus      18.54223 28.280299
palpebrosus          0.00000 39.364091
everetti            39.36409  0.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PCA scores</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>Zosterops_PCAcentroids_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Zosterops_PCAdf, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span>  <span class="co"># Add points for PCA scores</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Zosterops_PCAcentroids, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2), </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Add centroids</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PCA of Zosterops SNPs"</span>, <span class="at">x =</span> <span class="st">"PC1"</span>, <span class="at">y =</span> <span class="st">"PC2"</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> ColorPal_CUSTOM) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Zosterops_PCAcentroids_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/Centroid distances based on the first 3 PCs-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Export both the two principal components and three principal components plots (<code>PC2Dplot</code> and <code>PC3Dplot</code>) as html widgets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export PC3Dplot as html using the htmlWidgets package or from the menu in the RStudio viewer.</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(PC2Dplot), <span class="at">file =</span> <span class="st">"Zosterops2DPCAplot.html"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(PC3Dplot), <span class="at">file =</span> <span class="st">"Zosterops3DPCAplot.html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="uniform-manifold-approximation-and-projection-umap" class="level2">
<h2 class="anchored" data-anchor-id="uniform-manifold-approximation-and-projection-umap">Uniform manifold approximation and projection (UMAP)</h2>
<p>Uniform manifold approximation and projection (UMAP) <span class="citation" data-cites="uniform2024">(<a href="#ref-uniform2024" role="doc-biblioref"><span>“Uniform Manifold Approximation and Projection”</span> 2024</a>)</span> is a non-linear, stochastic algorithm to reduce dimensionality for visualization of multivariate data. UMAP seeks to preserve as much of the relationships among groups in the dataset as possible while reducing to a minimal number of components. In this case we are visualizing the SNP data with UMAP for two and three dimensions using the <code>umap</code> package and plotting the results for each analysis using the <code>plot_ly</code> command from the <code>plotly</code> package. The <code>n_neighbors</code>, <code>min_dist</code>, and <code>metric arguments</code> all reflect the default values. For each plot save as <code>html</code> files using the <code>saveWidget</code> command in the <code>htmlwidgets</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>UMAPseed <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>, <span class="dv">1</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(UMAPseed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(UMAPseed)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define color palette</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>ColorPal_UMAP <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#004949"</span>, <span class="st">"#DB6D00"</span>, <span class="st">"#D82632"</span>, <span class="st">"#290AD8"</span>, <span class="st">"#FED439"</span>, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"#B66DFF"</span>, <span class="st">"#006DDB"</span>, <span class="st">"#FA9C88"</span>, <span class="st">"#924900"</span>, </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"#7BA9CB"</span>, <span class="st">"#008600"</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract SNP data</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPs_UMAP <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">tab</span>(gl.ZosteropsSNPs))  <span class="co"># Use tab() to get the SNP data</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_results <span class="ot">&lt;-</span> <span class="fu">umap</span>(ZosteropsSNPs_UMAP, <span class="at">n_neighbors =</span> <span class="dv">15</span>, <span class="at">min_dist =</span> <span class="fl">0.1</span>, <span class="at">metric =</span> <span class="st">'euclidean'</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ZosteropsUMAP_results<span class="sc">$</span>layout)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_df<span class="sc">$</span>Taxon <span class="ot">&lt;-</span> <span class="fu">pop</span>(gl.ZosteropsSNPs)  <span class="co"># Add population information</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_2Dplot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> ZosteropsUMAP_df, <span class="at">x =</span> <span class="sc">~</span>V1, <span class="at">y =</span> <span class="sc">~</span>V2, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">'black'</span>)),</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="sc">~</span>Taxon, <span class="at">colors =</span> ColorPal_UMAP) <span class="sc">%&gt;%</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'UMAP 1'</span>),</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'UMAP 2'</span>))</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_2Dplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-56972dfb705813a02aca" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-56972dfb705813a02aca">{"x":{"visdat":{"1d5a3f90e8f4":["function () ","plotlyVisDat"]},"cur_data":"1d5a3f90e8f4","attrs":{"1d5a3f90e8f4":{"x":{},"y":{},"mode":"markers","marker":{"size":15,"line":{"width":1,"color":"black"}},"color":{},"colors":["#004949","#DB6D00","#D82632","#290AD8","#FED439","#B66DFF","#006DDB","#FA9C88","#924900","#7BA9CB","#008600"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"UMAP 1"},"yaxis":{"domain":[0,1],"automargin":true,"title":"UMAP 2"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-2.8240592473135333,-2.8349728973506063,-2.7568748683922784,-2.8705393989837389,-2.8687994085562161,-2.5003980667639243],"y":[0.6265921285383953,0.60791248171571288,0.6801734791827152,0.58752089866006574,0.57814884678420819,0.80864989410234411],"mode":"markers","marker":{"color":"rgba(0,73,73,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"erythropleurus","textfont":{"color":"rgba(0,73,73,1)"},"error_y":{"color":"rgba(0,73,73,1)"},"error_x":{"color":"rgba(0,73,73,1)"},"line":{"color":"rgba(0,73,73,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-1.4242988126569744,-1.483643262291731,-1.336019820669446],"y":[-2.9816233291203997,-3.0239566338462063,-2.8958468311685355],"mode":"markers","marker":{"color":"rgba(219,109,0,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"everetti","textfont":{"color":"rgba(219,109,0,1)"},"error_y":{"color":"rgba(219,109,0,1)"},"error_x":{"color":"rgba(219,109,0,1)"},"line":{"color":"rgba(219,109,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[3.8608020576086717,4.018464488644212,4.2240809116487119,3.3483628195871185,3.7001981567855098,3.895980664080378,3.2973137592786386,4.0840662126189748,4.1271365384507996,4.2453331743939602,3.9039127414696271,3.9491567812606889,3.5990284038595788,2.6849063703864955,3.4293738932046272,3.4960701239721859,2.844552046144162,3.2415741964927145,3.2449341468687916,2.7161090605695444,3.1817206669814682,3.0078477422549503,3.6578670325278173,2.963998994840531,3.7008938521596582,4.5133710313453479,4.2756490331255828,4.6575342012935694,4.5005328357041403,4.4691178781375474,4.3733276619602073,4.0332697177935604,4.3987182873546082,2.9729004819355622,3.3374266410018008,3.1592191561646197,3.5231669698455685,3.2560738051001117],"y":[0.32407756995551934,0.70008918772913287,1.3416270720201333,0.99887476488826321,0.99124846931756672,0.96392656327846771,1.0135255797994063,0.56580164879777128,0.66994981863056013,1.3052766165025698,1.172199699815039,0.19493330954511592,0.47622658998886092,0.87092065034313682,0.63474985608590306,0.44011049612691333,0.64820888728541748,1.1359129879703509,0.73180994917031716,0.79224494936506984,0.21330031369592636,0.37218093943105318,0.29424965363044414,1.2786734298923688,0.78273780523551828,-0.57679215653573457,-0.12293316840211319,-0.70560965807832088,-0.65681610832018245,-0.49259636872779761,-0.6665671369357018,0.11454184928826094,0.33307614793412738,0.09666640489850685,-0.20852605168873406,1.0158421948381091,-0.25751579385141327,-0.13195086578986054],"mode":"markers","marker":{"color":"rgba(216,38,50,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"japonicus","textfont":{"color":"rgba(216,38,50,1)"},"error_y":{"color":"rgba(216,38,50,1)"},"error_x":{"color":"rgba(216,38,50,1)"},"line":{"color":"rgba(216,38,50,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[4.9627032929390955,5.0870182073287946,4.9190888024846089,5.001850245955433,4.7479809999847085,4.8731467570480538,5.1924520169421804],"y":[-1.6481482798458487,-1.5045823326564431,-1.6369363321720267,-1.4356359588602789,-1.8584981244021539,-1.5290351440352132,-1.6194822079630504],"mode":"markers","marker":{"color":"rgba(41,10,216,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"japonicus_alani","textfont":{"color":"rgba(41,10,216,1)"},"error_y":{"color":"rgba(41,10,216,1)"},"error_x":{"color":"rgba(41,10,216,1)"},"line":{"color":"rgba(41,10,216,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.2304294081257827,1.6717388833572295,1.5978900683204864,1.7318683099040619,1.6414624769285679,1.3991824069216234,1.3173231675022254,1.4553254614333566,1.1468521158611955,1.0567631896684946,1.3628615119611878,1.4541827306450505],"y":[3.6116217449822599,3.1879551130730244,3.3417765308989136,3.0736250034955637,3.3615969587197569,3.5041898682170967,3.470149147643053,3.7922377987680047,3.6740825564182127,3.6054230198396335,3.8026557587174872,3.4043937808763851],"mode":"markers","marker":{"color":"rgba(254,212,57,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"meyeni","textfont":{"color":"rgba(254,212,57,1)"},"error_y":{"color":"rgba(254,212,57,1)"},"error_x":{"color":"rgba(254,212,57,1)"},"line":{"color":"rgba(254,212,57,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.6363453101575971,1.4358645193466815,1.7965005365742881,1.7412824908187605,1.5765388964084512,1.6791110113500707],"y":[1.1116997728662554,1.4762718767142553,1.3113841952918337,1.3900893189094929,1.1696504647325094,1.3538603543523797],"mode":"markers","marker":{"color":"rgba(182,109,255,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"montanus_NORTH","textfont":{"color":"rgba(182,109,255,1)"},"error_y":{"color":"rgba(182,109,255,1)"},"error_x":{"color":"rgba(182,109,255,1)"},"line":{"color":"rgba(182,109,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.6904116756371359,1.4988764030803439],"y":[2.0557025783137006,1.9987506886408481],"mode":"markers","marker":{"color":"rgba(0,109,219,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"montanus_PALAWAN","textfont":{"color":"rgba(0,109,219,1)"},"error_y":{"color":"rgba(0,109,219,1)"},"error_x":{"color":"rgba(0,109,219,1)"},"line":{"color":"rgba(0,109,219,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-3.0208092772192221,-2.8522469854943844,-3.0637613705802949,-3.3054818470417207,-3.6619986274985998,-3.5549597764096794,-3.5651046205888592,-3.6611970525062905,-2.6066669911499836,-3.1265577096032318,-3.2097667322178518,-3.1010275912844349,-3.0271518212787831,-2.921917110370293,-2.8774575391912016,-3.0914029320149403,-3.755349297978106],"y":[3.1774824130013033,3.3121107380109871,3.1150410702513947,3.1560289944730044,3.4554909676850198,3.5889543897769745,3.6325257313013424,3.3670808633529146,2.9914988046052913,3.4808262969828125,3.5935692716435041,3.7437735622498853,3.7036023264501026,3.4391427686717817,3.5391673833508972,3.7560900469762726,3.3280442707198929],"mode":"markers","marker":{"color":"rgba(250,156,136,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"montanus_SOUTH","textfont":{"color":"rgba(250,156,136,1)"},"error_y":{"color":"rgba(250,156,136,1)"},"error_x":{"color":"rgba(250,156,136,1)"},"line":{"color":"rgba(250,156,136,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-1.3204798316123141,-1.2136731975288642,-3.4105389187204058,-1.2249418161758439,-1.279831100014245],"y":[-2.8958760826572316,-2.7635151452470428,3.7756034800116676,-2.9240377045739221,-2.8513883935532327],"mode":"markers","marker":{"color":"rgba(146,73,0,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"nigrorum","textfont":{"color":"rgba(146,73,0,1)"},"error_y":{"color":"rgba(146,73,0,1)"},"error_x":{"color":"rgba(146,73,0,1)"},"line":{"color":"rgba(146,73,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.46771243602921075,0.32831397280333663,0.45080174336630391,0.30981424833748916],"y":[0.85872278612373631,0.68917348675786094,0.842599298361278,0.69517740630901925],"mode":"markers","marker":{"color":"rgba(123,169,203,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"palpebrosus","textfont":{"color":"rgba(123,169,203,1)"},"error_y":{"color":"rgba(123,169,203,1)"},"error_x":{"color":"rgba(123,169,203,1)"},"line":{"color":"rgba(123,169,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-5.4732901497288369,-4.9644774868923225,-4.8027345639439156,-5.0457122384274546,-5.3909859204137689,-4.1815415623800867,-5.0559264972661655,-5.1853756935873818,-4.7500218119108721,-5.0364576624811308,-4.6952089641750669,-4.8160193864170617,-4.9125016245932249,-5.6353077181286197,-5.5996066812802416,-5.4727548428389667,-5.5746288430758044,-4.5147426191564826,-5.1573271898620723,-5.3414425046482954,-5.1782588514892165,-5.5374053680009938,-4.9930357548376536,-5.2889939690802921],"y":[-4.5559035887609065,-4.5360310723502613,-3.9822703513054494,-4.4898650553956374,-4.3411460242396771,-3.6255390623232899,-4.6861468208093164,-4.2338510960452629,-4.0857047653364473,-4.956023348288265,-4.9409793680050234,-4.8724029299523588,-4.8053272149680097,-4.2481677930552806,-4.7527825049688017,-4.9220373135222539,-4.7144336442368582,-4.284194164426915,-4.4198208074663112,-4.7944325115196103,-4.3259586371707943,-4.2544821415913354,-4.9345901997179329,-4.150843799093435],"mode":"markers","marker":{"color":"rgba(0,134,0,1)","size":15,"line":{"color":"black","width":1}},"type":"scatter","name":"simplex","textfont":{"color":"rgba(0,134,0,1)"},"error_y":{"color":"rgba(0,134,0,1)"},"error_x":{"color":"rgba(0,134,0,1)"},"line":{"color":"rgba(0,134,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      V1         V2            Taxon
ZJlo012        3.8608021  0.3240776        japonicus
ZJlo015        4.0184645  0.7000892        japonicus
ZJlo016        4.2240809  1.3416271        japonicus
ZJlo017        3.3483628  0.9988748        japonicus
ZJlo021        3.7001982  0.9912485        japonicus
ZJlo022        3.8959807  0.9639266        japonicus
ZJlo024        3.2973138  1.0135256        japonicus
ZJlo031        4.0840662  0.5658016        japonicus
ZJlo045        4.1271365  0.6699498        japonicus
ZJlo046        4.2453332  1.3052766        japonicus
ZJlo050        3.9039127  1.1721997        japonicus
ZJlo052        3.9491568  0.1949333        japonicus
ZJlo055        3.5990284  0.4762266        japonicus
ZJja001        2.6849064  0.8709207        japonicus
ZJja002        3.4293739  0.6347499        japonicus
ZJja003        3.4960701  0.4401105        japonicus
ZJja004        2.8445520  0.6482089        japonicus
ZJja005        3.2415742  1.1359130        japonicus
ZJja009        3.2449341  0.7318099        japonicus
ZJja010        2.7161091  0.7922449        japonicus
ZJja012        3.1817207  0.2133003        japonicus
ZJja013        3.0078477  0.3721809        japonicus
ZJja014        3.6578670  0.2942497        japonicus
ZJja016        2.9639990  1.2786734        japonicus
ZJja030        3.7008939  0.7827378        japonicus
ZJal003        4.9627033 -1.6481483  japonicus_alani
Zjal004        5.0870182 -1.5045823  japonicus_alani
ZJal005        4.9190888 -1.6369363  japonicus_alani
ZJal010        5.0018502 -1.4356360  japonicus_alani
ZJal011        4.7479810 -1.8584981  japonicus_alani
ZJal012        4.8731468 -1.5290351  japonicus_alani
ZJal020        5.1924520 -1.6194822  japonicus_alani
ZJst007        4.5133710 -0.5767922        japonicus
ZJst009        4.2756490 -0.1229332        japonicus
ZJst010        4.6575342 -0.7056097        japonicus
ZJst012        4.5005328 -0.6568161        japonicus
ZJst014        4.4691179 -0.4925964        japonicus
ZJst015        4.3733277 -0.6665671        japonicus
ZJin001        4.0332697  0.1145418        japonicus
ZJin003        4.3987183  0.3330761        japonicus
ZJsi002       -5.4732901 -4.5559036          simplex
ZJsi017       -4.9644775 -4.5360311          simplex
ZJsi032       -4.8027346 -3.9822704          simplex
ZJsi023       -5.0457122 -4.4898651          simplex
ZJsi024       -5.3909859 -4.3411460          simplex
ZJsi027       -4.1815416 -3.6255391          simplex
ZJsi028       -5.0559265 -4.6861468          simplex
ZJsi029       -5.1853757 -4.2338511          simplex
ZJsi031       -4.7500218 -4.0857048          simplex
ZPxx001       -5.0364577 -4.9560233          simplex
ZPxx002       -4.6952090 -4.9409794          simplex
ZMxx002        1.2304294  3.6116217           meyeni
ZMxx003        1.6717389  3.1879551           meyeni
ZMxx004        1.5978901  3.3417765           meyeni
ZMxx005        1.7318683  3.0736250           meyeni
ZMxx006        1.6414625  3.3615970           meyeni
ZMOxx001      -3.0208093  3.1774824   montanus_SOUTH
ZMOxx002      -2.8522470  3.3121107   montanus_SOUTH
ZMOxx003      -3.0637614  3.1150411   montanus_SOUTH
ZMOxx005      -3.3054818  3.1560290   montanus_SOUTH
ZMOha001       1.6363453  1.1116998   montanus_NORTH
ZMOwh002       1.4358645  1.4762719   montanus_NORTH
ZMOwh003       1.7965005  1.3113842   montanus_NORTH
ZMOwh004       1.7412825  1.3900893   montanus_NORTH
ZMOwh005       1.5765389  1.1696505   montanus_NORTH
ZMOwh006       1.6791110  1.3538604   montanus_NORTH
ZMOvu002      -3.6619986  3.4554910   montanus_SOUTH
ZMOvu003      -3.5549598  3.5889544   montanus_SOUTH
ZMOvu004      -3.5651046  3.6325257   montanus_SOUTH
ZMOvu005      -3.6611971  3.3670809   montanus_SOUTH
ZMOmo001      -2.6066670  2.9914988   montanus_SOUTH
ZMOpa001       1.6904117  2.0557026 montanus_PALAWAN
ZMOpa002       1.4988764  1.9987507 montanus_PALAWAN
ZNni001       -1.3204798 -2.8958761         nigrorum
ZERxx002      -2.8240592  0.6265921   erythropleurus
ZERxx004      -2.8349729  0.6079125   erythropleurus
ZERxx005      -2.7568749  0.6801735   erythropleurus
Zsim23588     -4.8160194 -4.8724029          simplex
Zsim28142     -4.9125016 -4.8053272          simplex
Zsim30897      0.4677124  0.8587228      palpebrosus
Zpal23498      0.3283140  0.6891735      palpebrosus
Zpal23522      0.4508017  0.8425993      palpebrosus
Zmon20893     -3.1265577  3.4808263   montanus_SOUTH
Zmon20892     -3.2097667  3.5935693   montanus_SOUTH
Zmon20902     -3.1010276  3.7437736   montanus_SOUTH
Zmon20909     -3.0271518  3.7036023   montanus_SOUTH
Zsim31166     -2.9219171  3.4391428   montanus_SOUTH
Zsim31159     -2.8774575  3.5391674   montanus_SOUTH
Zmey17876      1.3991824  3.5041899           meyeni
Zmey17877      1.3173232  3.4701491           meyeni
Zmey17852      1.4553255  3.7922378           meyeni
Zmey17922      1.1468521  3.6740826           meyeni
Zmey17920      1.0567632  3.6054230           meyeni
Zmey17925      1.3628615  3.8026558           meyeni
Zmey17923      1.4541827  3.4043938           meyeni
Zery28090     -2.8705394  0.5875209   erythropleurus
Zery28091     -2.8687994  0.5781488   erythropleurus
Zery28088     -2.5003981  0.8086499   erythropleurus
Zni10863      -1.2136732 -2.7635151         nigrorum
Zni14341      -3.4105389  3.7756035         nigrorum
Zni19650      -1.2249418 -2.9240377         nigrorum
Zni17984      -1.2798311 -2.8513884         nigrorum
ZjaDOT-10981   0.3098142  0.6951774      palpebrosus
ZjaDOT-5235   -5.6353077 -4.2481678          simplex
Z_LA_122866_2 -5.5996067 -4.7527825          simplex
Z_LA_122577_2 -5.4727548 -4.9220373          simplex
Z_LA_122188_2 -5.5746288 -4.7144336          simplex
Zsim13809     -4.5147426 -4.2841942          simplex
Zsim13773     -5.1573272 -4.4198208          simplex
Zsim6797      -5.3414425 -4.7944325          simplex
Zsim10336     -5.1782589 -4.3259586          simplex
Zsim11362     -5.5374054 -4.2544821          simplex
Zsim11102     -4.9930358 -4.9345902          simplex
Zsim11220     -5.2889940 -4.1508438          simplex
Zmon20899     -3.0914029  3.7560900   montanus_SOUTH
Zmon28375     -3.7553493  3.3280443   montanus_SOUTH
Zev13949      -1.4242988 -2.9816233         everetti
Zev31650      -1.4836433 -3.0239566         everetti
Zev28451      -1.3360198 -2.8958468         everetti
Z_HI_BRY431    2.9729005  0.0966664        japonicus
Z_HI_NAN290    3.3374266 -0.2085261        japonicus
Z_HI_WAI087    3.1592192  1.0158422        japonicus
Z_HI_WAI078    3.5231670 -0.2575158        japonicus
Z_HI_SOL783    3.2560738 -0.1319509        japonicus</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_3Dresults <span class="ot">&lt;-</span> <span class="fu">umap</span>(ZosteropsSNPs_UMAP, <span class="at">n_neighbors =</span> <span class="dv">15</span>, <span class="at">min_dist =</span> <span class="fl">0.1</span>, <span class="at">metric =</span> <span class="st">'euclidean'</span>, <span class="at">n_components =</span> <span class="dv">3</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_3Ddf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ZosteropsUMAP_3Dresults<span class="sc">$</span>layout)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_3Ddf<span class="sc">$</span>Taxon <span class="ot">&lt;-</span> <span class="fu">pop</span>(gl.ZosteropsSNPs)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_3Dplot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> ZosteropsUMAP_3Ddf, <span class="at">x =</span> <span class="sc">~</span>V1, <span class="at">y =</span> <span class="sc">~</span>V2, <span class="at">z =</span> <span class="sc">~</span>V3, <span class="at">type =</span> <span class="st">'scatter3d'</span>, <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">'black'</span>)),  <span class="co"># Add line around markers</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> <span class="sc">~</span>Taxon, <span class="at">colors =</span> ColorPal_UMAP) <span class="sc">%&gt;%</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'UMAP 1'</span>),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'UMAP 2'</span>),</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'UMAP 3'</span>)))</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_3Dplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9bb7d113c45a5d922c56" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9bb7d113c45a5d922c56">{"x":{"visdat":{"1d5a42ae0bc6":["function () ","plotlyVisDat"]},"cur_data":"1d5a42ae0bc6","attrs":{"1d5a42ae0bc6":{"x":{},"y":{},"z":{},"mode":"markers","marker":{"size":10,"line":{"width":1,"color":"black"}},"color":{},"colors":["#004949","#DB6D00","#D82632","#290AD8","#FED439","#B66DFF","#006DDB","#FA9C88","#924900","#7BA9CB","#008600"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"UMAP 1"},"yaxis":{"title":"UMAP 2"},"zaxis":{"title":"UMAP 3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1.3825279952272285,1.2970366949261671,1.4608390741993824,1.5103369792222909,1.5839998443303425,1.1374364413405953],"y":[-0.59127346065492037,-0.48509231363442074,-0.68840075179927473,-0.69133905916268401,-0.62078899351013539,-0.41583519658319035],"z":[-2.1700507932345299,-2.3064737940475388,-2.0989954959103909,-2.1909730248998636,-2.2773765566137554,-2.1322633263463397],"mode":"markers","marker":{"color":"rgba(0,73,73,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"erythropleurus","textfont":{"color":"rgba(0,73,73,1)"},"error_y":{"color":"rgba(0,73,73,1)"},"error_x":{"color":"rgba(0,73,73,1)"},"line":{"color":"rgba(0,73,73,1)"},"frame":null},{"x":[3.0443412411420265,3.0598794380461443,3.0146878950645517],"y":[0.440646714028472,0.46050040213618137,0.43874188124048374],"z":[-5.4369737237192162,-5.449490698514027,-5.3955278314532364],"mode":"markers","marker":{"color":"rgba(219,109,0,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"everetti","textfont":{"color":"rgba(219,109,0,1)"},"error_y":{"color":"rgba(219,109,0,1)"},"error_x":{"color":"rgba(219,109,0,1)"},"line":{"color":"rgba(219,109,0,1)"},"frame":null},{"x":[-1.9637664294245745,-1.9756287367832692,-2.1930768105515464,-1.7419411033866392,-1.8183348173623093,-1.8619961343302183,-1.8982024554786896,-2.1839824929812028,-1.9860525571774492,-1.9782736871752238,-2.13993010454453,-2.2635294915270636,-2.1132436524030789,-1.1660404064391126,-1.3991685190899943,-1.5925988270867804,-1.2993356085370003,-1.4048363481636368,-1.5091134209401231,-1.2272148183735176,-1.3896934806201047,-1.6670544714638298,-2.2990617429148026,-1.0473006762079582,-1.569321556375576,-2.5535787782046535,-2.3324679914638589,-2.6465121336841966,-2.725084202514279,-2.7417141095234472,-2.8954923787722295,-1.9487380274511155,-2.2197464228943531,-1.4792709227074747,-1.5911074668670586,-0.97804722553947188,-1.4964151415827736,-1.7818597779198229],"y":[-2.8028734747149935,-2.2598541850255627,-2.7757208185637561,-2.6318285081707362,-2.2888574177825758,-2.0046516526359177,-2.6002983364442409,-2.4149058837646171,-2.395124937379423,-2.8350496377100542,-2.2543807232691675,-2.5303783627172995,-2.5349207677649463,-1.7127962738846729,-2.1364768778889642,-2.0224730437616163,-1.6482032403379174,-2.2179411115700525,-2.0683009455945394,-2.4257893303282865,-2.5724768179872761,-1.7794369334723481,-2.017721731220731,-2.0980351695963311,-2.3673086364829956,-1.6707782552561625,-1.6197680824515779,-1.6000099189812029,-1.3462543003359773,-1.4740558657428837,-1.5468252026590472,-2.2570616696707102,-2.5022301859552671,-1.8018061944644066,-2.1525919064138543,-1.709675762807038,-2.466573894153993,-1.7852101805167961],"z":[2.1418488235672264,2.1283544029030228,2.3338332114905906,2.5082906392046143,2.476689870718757,2.4687815020214252,2.5393451719873781,1.9226588762772818,2.0551469247063778,2.0259846384029139,2.502875984736014,2.3585227999224383,2.440845783816826,2.389429200815874,2.0043345226287208,2.2346917631353396,2.219528780324513,2.2159137511179976,2.5648298579162567,2.3522370109766229,1.9018638705142001,2.1747240660679878,1.8684607780600271,2.1128492335490074,2.2460293873918706,1.5976952208189934,1.8451386733327115,1.5473336186569429,1.7401247479125697,1.5784841445940263,1.4979602863850767,1.4932224767643054,1.6020254345373337,1.7929096135789961,1.5788345301081173,1.9721846439384143,1.6585401068316232,1.6156281370231291],"mode":"markers","marker":{"color":"rgba(216,38,50,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"japonicus","textfont":{"color":"rgba(216,38,50,1)"},"error_y":{"color":"rgba(216,38,50,1)"},"error_x":{"color":"rgba(216,38,50,1)"},"line":{"color":"rgba(216,38,50,1)"},"frame":null},{"x":[-3.6246094175479051,-3.8082287669684076,-3.6275903561991827,-3.8340752561210625,-3.7122653325178145,-3.7510826099137891,-3.864603088466315],"y":[-1.4326169512297524,-1.4458201620806606,-1.3596341703531383,-1.5475439288720507,-1.3152682354098262,-1.2731328262508936,-1.3277763964415399],"z":[1.5342052179068488,1.4096178673998703,1.5016982255561457,1.3184624634216673,1.5468023019357655,1.6122482920508479,1.4603314160654766],"mode":"markers","marker":{"color":"rgba(41,10,216,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"japonicus_alani","textfont":{"color":"rgba(41,10,216,1)"},"error_y":{"color":"rgba(41,10,216,1)"},"error_x":{"color":"rgba(41,10,216,1)"},"line":{"color":"rgba(41,10,216,1)"},"frame":null},{"x":[1.366040733200053,1.4619836631177785,1.4830604718241756,1.5191963027700381,1.5203780078851348,1.5018366293992955,1.2369543575322521,1.5835216883626244,1.6087821593986762,1.5534973149427276,1.4084174757390047,1.11723284448462],"y":[-1.076821451767316,-1.2599824052186499,-1.304740135796534,-1.3521913106934293,-1.345347127619285,-1.2138413842878408,-1.1011216556195003,-1.2169675686407009,-1.2588475835684869,-1.2294110546472676,-1.258402708627955,-1.1578248722094295],"z":[2.279567846228681,1.8919296095320408,1.9838474425421919,1.775671060107648,1.898437900163757,2.576268818725703,2.3620309585600126,2.4568561247411598,2.4168704722360461,2.2827385562148708,2.4113166165259132,2.5011222577305467],"mode":"markers","marker":{"color":"rgba(254,212,57,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"meyeni","textfont":{"color":"rgba(254,212,57,1)"},"error_y":{"color":"rgba(254,212,57,1)"},"error_x":{"color":"rgba(254,212,57,1)"},"line":{"color":"rgba(254,212,57,1)"},"frame":null},{"x":[-0.28516993286311787,-0.26748904373716642,-0.16667431687953171,-0.42711832719901088,-0.46568417799296591,-0.33083190504461713],"y":[-0.82794130989534787,-1.2029564735775791,-1.0094366490923761,-1.0849978542480747,-0.71563396642044741,-0.75023494318499684],"z":[2.0151873377517973,2.2959560576758156,2.091736716939284,2.0412149851940482,1.8878167489369668,1.8932482543693407],"mode":"markers","marker":{"color":"rgba(182,109,255,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"montanus_NORTH","textfont":{"color":"rgba(182,109,255,1)"},"error_y":{"color":"rgba(182,109,255,1)"},"error_x":{"color":"rgba(182,109,255,1)"},"line":{"color":"rgba(182,109,255,1)"},"frame":null},{"x":[0.22822282351964263,0.32790630694680734],"y":[-0.67237739357659909,-0.77649118890038138],"z":[1.9590658943546695,2.0658285576173796],"mode":"markers","marker":{"color":"rgba(0,109,219,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"montanus_PALAWAN","textfont":{"color":"rgba(0,109,219,1)"},"error_y":{"color":"rgba(0,109,219,1)"},"error_x":{"color":"rgba(0,109,219,1)"},"line":{"color":"rgba(0,109,219,1)"},"frame":null},{"x":[1.5160654997917518,1.4864160349024462,1.5348118257290855,1.6795371524007465,1.4684129110095734,1.7986338910203232,1.6846124866022869,1.4665662315178447,1.3199585542296901,1.4143089431053644,1.255711004087996,1.3094166467653168,1.2260297415338333,1.1902101543379811,1.2112335231367051,1.1541066612648163,1.8117252959847063],"y":[3.2926691508784471,3.1355818902909678,3.0743326633903409,3.2133556262892338,2.9681407269870164,2.9200839220631405,2.9135169192005592,2.6777381966933973,2.3289055714915965,3.6337186796162122,3.3874296155189203,3.4630080085964172,3.3060694759629037,2.7980200535503199,2.7717846014444714,3.4798389048239109,2.7188040992390041],"z":[3.4240674944248291,3.2110942694540929,3.2443557823593894,3.2733641595599758,3.6452740991865795,3.7371695150596498,3.6657014465116671,3.3915810360795975,3.3425954585032125,3.4518737679571085,3.6114681321266877,3.6020721307405816,3.6033462707449262,3.5870072003358251,3.5719177747431656,3.7132925671946309,3.6784743013631678],"mode":"markers","marker":{"color":"rgba(250,156,136,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"montanus_SOUTH","textfont":{"color":"rgba(250,156,136,1)"},"error_y":{"color":"rgba(250,156,136,1)"},"error_x":{"color":"rgba(250,156,136,1)"},"line":{"color":"rgba(250,156,136,1)"},"frame":null},{"x":[3.1430259411997947,3.1911860723556087,1.7366272610770404,3.1055690630084185,3.1269666289969651],"y":[0.35399023065410096,0.33292262533816852,2.8430831128770366,0.3866533724654424,0.36246532599981474],"z":[-5.5223751700746782,-5.2133555842861989,3.9023375717075517,-5.3708708422762212,-5.3815109994754318],"mode":"markers","marker":{"color":"rgba(146,73,0,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"nigrorum","textfont":{"color":"rgba(146,73,0,1)"},"error_y":{"color":"rgba(146,73,0,1)"},"error_x":{"color":"rgba(146,73,0,1)"},"line":{"color":"rgba(146,73,0,1)"},"frame":null},{"x":[0.76069879838246024,0.83825592042990571,0.81669179846617845,0.81856688319193172],"y":[0.54346254031637864,0.68895200958546288,0.59729080801591472,0.6206631640355329],"z":[-2.4378749920668783,-2.5738303639833129,-2.4737522923517461,-2.5070415237987915],"mode":"markers","marker":{"color":"rgba(123,169,203,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"palpebrosus","textfont":{"color":"rgba(123,169,203,1)"},"error_y":{"color":"rgba(123,169,203,1)"},"error_x":{"color":"rgba(123,169,203,1)"},"line":{"color":"rgba(123,169,203,1)"},"frame":null},{"x":[0.76354655046686426,1.2674237843170222,0.95869838820893616,0.66763266630798102,0.98732213799084356,0.86362866805404248,0.93771566200318079,1.1545590012659652,0.81503915322919152,1.2850511213726885,1.0843301449266658,0.95832675628795594,0.79513895908545851,1.0773720597468994,0.99169375261921366,0.96724570594726456,0.65599375313968733,0.67047319055852594,0.68213686520857175,1.1149509740196728,0.83006938269770725,0.81522125701499848,0.75041262245541906,0.67671159583891449],"y":[2.2662544817804524,2.3535329653976618,1.9658161420740299,2.3756993115190128,2.2718594488200847,1.427470479186842,2.2372742323850154,2.493929075318507,1.9107166246434097,2.14949450573741,1.9537907440643028,2.3064303910015145,2.4698582268550791,2.6328816039166911,2.8041006804020201,2.8368626080793655,2.8673316021140138,1.9428395973239774,2.602345380508357,2.6155636808601108,2.3816247305088929,2.3976266925416718,2.3338366396485726,2.5892275836358416],"z":[-5.8551518328402761,-5.6100953787403203,-5.5468524358609912,-5.3741696291314209,-5.1943035182639461,-5.1467598561185612,-5.4184028213035145,-5.8866752254905226,-5.3693828048251353,-5.594270729921071,-5.6494893014686571,-5.6210512024343222,-5.4611845208555287,-5.8703359098904757,-5.6118867333516667,-5.5006703681232834,-5.5948038145295902,-5.6801828415353404,-5.2751437155198291,-5.3273710394754916,-5.8523184102165553,-5.8738889020769518,-5.6379131841822305,-5.9441822760649439],"mode":"markers","marker":{"color":"rgba(0,134,0,1)","size":10,"line":{"color":"black","width":1}},"type":"scatter3d","name":"simplex","textfont":{"color":"rgba(0,134,0,1)"},"error_y":{"color":"rgba(0,134,0,1)"},"error_x":{"color":"rgba(0,134,0,1)"},"line":{"color":"rgba(0,134,0,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>ZosteropsUMAP_3Ddf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      V1         V2        V3            Taxon
ZJlo012       -1.9637664 -2.8028735  2.141849        japonicus
ZJlo015       -1.9756287 -2.2598542  2.128354        japonicus
ZJlo016       -2.1930768 -2.7757208  2.333833        japonicus
ZJlo017       -1.7419411 -2.6318285  2.508291        japonicus
ZJlo021       -1.8183348 -2.2888574  2.476690        japonicus
ZJlo022       -1.8619961 -2.0046517  2.468782        japonicus
ZJlo024       -1.8982025 -2.6002983  2.539345        japonicus
ZJlo031       -2.1839825 -2.4149059  1.922659        japonicus
ZJlo045       -1.9860526 -2.3951249  2.055147        japonicus
ZJlo046       -1.9782737 -2.8350496  2.025985        japonicus
ZJlo050       -2.1399301 -2.2543807  2.502876        japonicus
ZJlo052       -2.2635295 -2.5303784  2.358523        japonicus
ZJlo055       -2.1132437 -2.5349208  2.440846        japonicus
ZJja001       -1.1660404 -1.7127963  2.389429        japonicus
ZJja002       -1.3991685 -2.1364769  2.004335        japonicus
ZJja003       -1.5925988 -2.0224730  2.234692        japonicus
ZJja004       -1.2993356 -1.6482032  2.219529        japonicus
ZJja005       -1.4048363 -2.2179411  2.215914        japonicus
ZJja009       -1.5091134 -2.0683009  2.564830        japonicus
ZJja010       -1.2272148 -2.4257893  2.352237        japonicus
ZJja012       -1.3896935 -2.5724768  1.901864        japonicus
ZJja013       -1.6670545 -1.7794369  2.174724        japonicus
ZJja014       -2.2990617 -2.0177217  1.868461        japonicus
ZJja016       -1.0473007 -2.0980352  2.112849        japonicus
ZJja030       -1.5693216 -2.3673086  2.246029        japonicus
ZJal003       -3.6246094 -1.4326170  1.534205  japonicus_alani
Zjal004       -3.8082288 -1.4458202  1.409618  japonicus_alani
ZJal005       -3.6275904 -1.3596342  1.501698  japonicus_alani
ZJal010       -3.8340753 -1.5475439  1.318462  japonicus_alani
ZJal011       -3.7122653 -1.3152682  1.546802  japonicus_alani
ZJal012       -3.7510826 -1.2731328  1.612248  japonicus_alani
ZJal020       -3.8646031 -1.3277764  1.460331  japonicus_alani
ZJst007       -2.5535788 -1.6707783  1.597695        japonicus
ZJst009       -2.3324680 -1.6197681  1.845139        japonicus
ZJst010       -2.6465121 -1.6000099  1.547334        japonicus
ZJst012       -2.7250842 -1.3462543  1.740125        japonicus
ZJst014       -2.7417141 -1.4740559  1.578484        japonicus
ZJst015       -2.8954924 -1.5468252  1.497960        japonicus
ZJin001       -1.9487380 -2.2570617  1.493222        japonicus
ZJin003       -2.2197464 -2.5022302  1.602025        japonicus
ZJsi002        0.7635466  2.2662545 -5.855152          simplex
ZJsi017        1.2674238  2.3535330 -5.610095          simplex
ZJsi032        0.9586984  1.9658161 -5.546852          simplex
ZJsi023        0.6676327  2.3756993 -5.374170          simplex
ZJsi024        0.9873221  2.2718594 -5.194304          simplex
ZJsi027        0.8636287  1.4274705 -5.146760          simplex
ZJsi028        0.9377157  2.2372742 -5.418403          simplex
ZJsi029        1.1545590  2.4939291 -5.886675          simplex
ZJsi031        0.8150392  1.9107166 -5.369383          simplex
ZPxx001        1.2850511  2.1494945 -5.594271          simplex
ZPxx002        1.0843301  1.9537907 -5.649489          simplex
ZMxx002        1.3660407 -1.0768215  2.279568           meyeni
ZMxx003        1.4619837 -1.2599824  1.891930           meyeni
ZMxx004        1.4830605 -1.3047401  1.983847           meyeni
ZMxx005        1.5191963 -1.3521913  1.775671           meyeni
ZMxx006        1.5203780 -1.3453471  1.898438           meyeni
ZMOxx001       1.5160655  3.2926692  3.424067   montanus_SOUTH
ZMOxx002       1.4864160  3.1355819  3.211094   montanus_SOUTH
ZMOxx003       1.5348118  3.0743327  3.244356   montanus_SOUTH
ZMOxx005       1.6795372  3.2133556  3.273364   montanus_SOUTH
ZMOha001      -0.2851699 -0.8279413  2.015187   montanus_NORTH
ZMOwh002      -0.2674890 -1.2029565  2.295956   montanus_NORTH
ZMOwh003      -0.1666743 -1.0094366  2.091737   montanus_NORTH
ZMOwh004      -0.4271183 -1.0849979  2.041215   montanus_NORTH
ZMOwh005      -0.4656842 -0.7156340  1.887817   montanus_NORTH
ZMOwh006      -0.3308319 -0.7502349  1.893248   montanus_NORTH
ZMOvu002       1.4684129  2.9681407  3.645274   montanus_SOUTH
ZMOvu003       1.7986339  2.9200839  3.737170   montanus_SOUTH
ZMOvu004       1.6846125  2.9135169  3.665701   montanus_SOUTH
ZMOvu005       1.4665662  2.6777382  3.391581   montanus_SOUTH
ZMOmo001       1.3199586  2.3289056  3.342595   montanus_SOUTH
ZMOpa001       0.2282228 -0.6723774  1.959066 montanus_PALAWAN
ZMOpa002       0.3279063 -0.7764912  2.065829 montanus_PALAWAN
ZNni001        3.1430259  0.3539902 -5.522375         nigrorum
ZERxx002       1.3825280 -0.5912735 -2.170051   erythropleurus
ZERxx004       1.2970367 -0.4850923 -2.306474   erythropleurus
ZERxx005       1.4608391 -0.6884008 -2.098995   erythropleurus
Zsim23588      0.9583268  2.3064304 -5.621051          simplex
Zsim28142      0.7951390  2.4698582 -5.461185          simplex
Zsim30897      0.7606988  0.5434625 -2.437875      palpebrosus
Zpal23498      0.8382559  0.6889520 -2.573830      palpebrosus
Zpal23522      0.8166918  0.5972908 -2.473752      palpebrosus
Zmon20893      1.4143089  3.6337187  3.451874   montanus_SOUTH
Zmon20892      1.2557110  3.3874296  3.611468   montanus_SOUTH
Zmon20902      1.3094166  3.4630080  3.602072   montanus_SOUTH
Zmon20909      1.2260297  3.3060695  3.603346   montanus_SOUTH
Zsim31166      1.1902102  2.7980201  3.587007   montanus_SOUTH
Zsim31159      1.2112335  2.7717846  3.571918   montanus_SOUTH
Zmey17876      1.5018366 -1.2138414  2.576269           meyeni
Zmey17877      1.2369544 -1.1011217  2.362031           meyeni
Zmey17852      1.5835217 -1.2169676  2.456856           meyeni
Zmey17922      1.6087822 -1.2588476  2.416870           meyeni
Zmey17920      1.5534973 -1.2294111  2.282739           meyeni
Zmey17925      1.4084175 -1.2584027  2.411317           meyeni
Zmey17923      1.1172328 -1.1578249  2.501122           meyeni
Zery28090      1.5103370 -0.6913391 -2.190973   erythropleurus
Zery28091      1.5839998 -0.6207890 -2.277377   erythropleurus
Zery28088      1.1374364 -0.4158352 -2.132263   erythropleurus
Zni10863       3.1911861  0.3329226 -5.213356         nigrorum
Zni14341       1.7366273  2.8430831  3.902338         nigrorum
Zni19650       3.1055691  0.3866534 -5.370871         nigrorum
Zni17984       3.1269666  0.3624653 -5.381511         nigrorum
ZjaDOT-10981   0.8185669  0.6206632 -2.507042      palpebrosus
ZjaDOT-5235    1.0773721  2.6328816 -5.870336          simplex
Z_LA_122866_2  0.9916938  2.8041007 -5.611887          simplex
Z_LA_122577_2  0.9672457  2.8368626 -5.500670          simplex
Z_LA_122188_2  0.6559938  2.8673316 -5.594804          simplex
Zsim13809      0.6704732  1.9428396 -5.680183          simplex
Zsim13773      0.6821369  2.6023454 -5.275144          simplex
Zsim6797       1.1149510  2.6155637 -5.327371          simplex
Zsim10336      0.8300694  2.3816247 -5.852318          simplex
Zsim11362      0.8152213  2.3976267 -5.873889          simplex
Zsim11102      0.7504126  2.3338366 -5.637913          simplex
Zsim11220      0.6767116  2.5892276 -5.944182          simplex
Zmon20899      1.1541067  3.4798389  3.713293   montanus_SOUTH
Zmon28375      1.8117253  2.7188041  3.678474   montanus_SOUTH
Zev13949       3.0443412  0.4406467 -5.436974         everetti
Zev31650       3.0598794  0.4605004 -5.449491         everetti
Zev28451       3.0146879  0.4387419 -5.395528         everetti
Z_HI_BRY431   -1.4792709 -1.8018062  1.792910        japonicus
Z_HI_NAN290   -1.5911075 -2.1525919  1.578835        japonicus
Z_HI_WAI087   -0.9780472 -1.7096758  1.972185        japonicus
Z_HI_WAI078   -1.4964151 -2.4665739  1.658540        japonicus
Z_HI_SOL783   -1.7818598 -1.7852102  1.615628        japonicus</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(ZosteropsUMAP_2Dplot), <span class="at">file =</span> <span class="st">"ZosteropsUMAP_2Dplot.html"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(ZosteropsUMAP_3Dplot), <span class="at">file =</span> <span class="st">"ZosteropsUMAP_3Dplot.html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="discriminant-analysis-of-principal-components-dapc" class="level2">
<h2 class="anchored" data-anchor-id="discriminant-analysis-of-principal-components-dapc">Discriminant analysis of principal components (DAPC)</h2>
<section id="dapc-cross-validation-a-scores-and-optimal-number-of-pcs-for-discrimination" class="level4">
<h4 class="anchored" data-anchor-id="dapc-cross-validation-a-scores-and-optimal-number-of-pcs-for-discrimination">DAPC cross-validation, a-scores, and optimal number of PCs for discrimination</h4>
<p>Discriminant analysis of principal components (DAPC) is a multivariate method that takes principal components (PCs) and partitions variance into within- and among-group components in a way that maximizes discrimination among the groups <span class="citation" data-cites="jombart2010">(<a href="#ref-jombart2010" role="doc-biblioref">Thibaut Jombart, Devillard, and Balloux 2010</a>)</span>. DAPC makes no explicit assumptions regarding recombination or panmixia. This allows use of the full SNP dataset without worrying about filtering to reduce the likelihood of linkage as is required for STRUCTURE or ADMIXTURE. A tutorial on DAPC is available <a href="https://grunwaldlab.github.io/Population_Genetics_in_R/DAPC.html">here</a>. First conduct a cross-validation analysis to help determine the optimal number of PCs to be retained in the DAPC. Test between 1 and 50 PCs (<code>n.pca = 1:50</code>) with 100 replicate runs per PC (<code>n.rep = 100</code>) of the cross-validation analysis. Use the multicore option and 6 CPUs (<code>ncpus = 6L</code>), or potentially more if your machine allows it. Even running multiple cores this run can take a while to execute. Executing this analysis within the <code>system.time</code> command will return an elapsed time for the operation. This will return a graph showing the proportion of successful group predictions on the y-axis and the results from the individual replicate runs for each PC on the x-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>DAPCseed <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>, <span class="dv">1</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(DAPCseed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 836</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(DAPCseed)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span> (ZosteropsSNPsDAPCpramx <span class="ot">&lt;-</span> <span class="fu">xvalDapc</span>(<span class="fu">tab</span>(gl.ZosteropsSNPs, <span class="at">NA.method =</span> <span class="st">"mean"</span>), <span class="fu">pop</span>(gl.ZosteropsSNPs), <span class="at">n.pca =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="at">n.rep =</span> <span class="dv">100</span>, <span class="at">parallel =</span> <span class="st">"multicore"</span>, <span class="at">ncpus =</span> <span class="dv">6</span>L))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC analysis cross validation-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    user   system  elapsed 
1686.290  271.423  361.423 </code></pre>
</div>
</div>
</section>
<section id="a-scores" class="level4">
<h4 class="anchored" data-anchor-id="a-scores"><em>a</em>-scores</h4>
<p>The DAPC cross validation provides some clues as to where we no longer need to add PCs to the DAPC to get increased discrimination, but we want to know exactly how many PCs is optimum for discrimination. The <em>a</em>-score is the difference between the proportion of successful reassignments using the real groups and assignments into randomly assigned groups. Thus the average <em>a</em>-score is the average percent improvement in discrimination over that based on random groupings. The code below will estimate the <em>a</em>-score across 30 replicate runs (<code>n.sim = 30</code>) and 40 PCs (<code>n.pca = 40</code>) showing the result per group for each run, the average across all replicates per group, and the overall average.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPsDAPC_OPTIMUM <span class="ot">&lt;-</span> <span class="fu">dapc</span>(gl.ZosteropsSNPs, <span class="at">n.pca =</span> <span class="dv">40</span>, <span class="at">n.da =</span> <span class="fu">nPop</span>(gl.ZosteropsSNPs)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">a.score</span>(ZosteropsSNPsDAPC_OPTIMUM, <span class="at">n.pca =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ZosteropsSNPsDAPC_OPTIMUM<span class="sc">$</span>tab), <span class="at">n=</span><span class="dv">30</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>, <span class="at">n.sim =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$tab
       erythropleurus  everetti  japonicus japonicus_alani    meyeni
sim.1       0.5000000 0.3333333 0.21052632       0.7142857 0.3333333
sim.2       0.5000000 0.0000000 0.36842105       0.7142857 0.6666667
sim.3       0.5000000 0.6666667 0.28947368       0.4285714 0.6666667
sim.4       0.5000000 0.3333333 0.23684211       0.4285714 0.5833333
sim.5       0.1666667 0.6666667 0.36842105       0.4285714 1.0000000
sim.6       0.5000000 0.6666667 0.31578947       0.5714286 0.6666667
sim.7       0.3333333 0.6666667 0.23684211       0.7142857 0.5000000
sim.8       0.8333333 0.0000000 0.21052632       0.7142857 0.2500000
sim.9       0.6666667 0.6666667 0.31578947       0.7142857 0.6666667
sim.10      0.6666667 0.3333333 0.42105263       0.2857143 0.6666667
sim.11      0.8333333 0.6666667 0.21052632       0.7142857 0.5833333
sim.12      0.6666667 0.3333333 0.15789474       0.4285714 0.5833333
sim.13      0.5000000 0.3333333 0.42105263       0.4285714 0.4166667
sim.14      0.3333333 0.3333333 0.26315789       0.5714286 0.9166667
sim.15      0.3333333 0.3333333 0.31578947       0.7142857 0.5833333
sim.16      0.5000000 0.3333333 0.39473684       0.4285714 0.5833333
sim.17      0.1666667 0.0000000 0.34210526       0.4285714 0.5833333
sim.18      0.6666667 0.6666667 0.18421053       0.5714286 0.5000000
sim.19      0.6666667 0.3333333 0.28947368       0.7142857 0.6666667
sim.20      0.8333333 0.6666667 0.15789474       0.8571429 0.5833333
sim.21      0.5000000 0.6666667 0.07894737       0.5714286 0.5833333
sim.22      0.5000000 0.3333333 0.21052632       0.5714286 0.5000000
sim.23      0.5000000 0.0000000 0.28947368       0.4285714 0.5000000
sim.24      0.5000000 0.3333333 0.18421053       0.7142857 0.3333333
sim.25      0.8333333 0.3333333 0.13157895       0.5714286 0.6666667
sim.26      0.1666667 0.6666667 0.18421053       0.5714286 0.5833333
sim.27      0.6666667 0.3333333 0.26315789       0.5714286 0.5000000
sim.28      0.6666667 0.3333333 0.28947368       0.4285714 0.5000000
sim.29      0.5000000 0.3333333 0.18421053       0.4285714 0.6666667
sim.30      0.3333333 0.6666667 0.28947368       0.5714286 0.5833333
       montanus_NORTH montanus_PALAWAN montanus_SOUTH nigrorum palpebrosus
sim.1       0.6666667              0.5      0.5882353      0.2        0.75
sim.2       0.8333333              0.5      0.5882353      0.4        0.50
sim.3       0.6666667              0.5      0.4705882      0.4        0.75
sim.4       0.5000000              0.5      0.5294118      0.4        0.75
sim.5       0.5000000              0.5      0.6470588      0.2        0.25
sim.6       0.8333333              0.5      0.5294118      0.6        0.50
sim.7       0.5000000              0.5      0.5882353      0.4        0.75
sim.8       0.5000000              0.0      0.4705882      0.6        0.75
sim.9       0.6666667              0.5      0.5882353      0.2        0.25
sim.10      0.6666667              0.5      0.7058824      0.6        0.50
sim.11      0.1666667              0.5      0.5882353      0.6        0.50
sim.12      0.8333333              0.5      0.3529412      0.6        0.50
sim.13      0.6666667              1.0      0.5882353      0.6        0.50
sim.14      0.6666667              0.5      0.4705882      0.8        0.25
sim.15      0.5000000              0.0      0.6470588      0.4        0.50
sim.16      0.6666667              0.5      0.5294118      0.4        0.50
sim.17      0.6666667              0.5      0.5882353      0.4        0.50
sim.18      0.5000000              0.5      0.5882353      0.2        0.75
sim.19      0.5000000              0.5      0.7058824      0.6        0.25
sim.20      0.8333333              0.5      0.6470588      0.6        0.50
sim.21      0.3333333              0.0      0.5294118      0.8        0.50
sim.22      0.6666667              0.5      0.7058824      0.4        0.50
sim.23      0.8333333              0.5      0.5882353      0.6        0.50
sim.24      0.6666667              0.0      0.5294118      0.6        0.75
sim.25      0.8333333              0.5      0.6470588      0.4        0.25
sim.26      0.5000000              0.0      0.5882353      0.4        0.75
sim.27      0.3333333              1.0      0.5294118      0.6        0.50
sim.28      0.6666667              0.0      0.5882353      0.8        1.00
sim.29      0.6666667              0.0      0.5294118      0.8        0.50
sim.30      0.5000000              0.5      0.5294118      0.6        0.75
         simplex
sim.1  0.4583333
sim.2  0.2916667
sim.3  0.5416667
sim.4  0.5833333
sim.5  0.2083333
sim.6  0.2916667
sim.7  0.3750000
sim.8  0.5833333
sim.9  0.2916667
sim.10 0.2083333
sim.11 0.5000000
sim.12 0.4583333
sim.13 0.1666667
sim.14 0.5000000
sim.15 0.5833333
sim.16 0.2083333
sim.17 0.5416667
sim.18 0.5833333
sim.19 0.2916667
sim.20 0.4583333
sim.21 0.6250000
sim.22 0.5833333
sim.23 0.2500000
sim.24 0.5416667
sim.25 0.5416667
sim.26 0.5416667
sim.27 0.5000000
sim.28 0.5000000
sim.29 0.5416667
sim.30 0.4166667

$pop.score
  erythropleurus         everetti        japonicus  japonicus_alani 
       0.5277778        0.4111111        0.2605263        0.5666667 
          meyeni   montanus_NORTH montanus_PALAWAN   montanus_SOUTH 
       0.5805556        0.6111111        0.4166667        0.5725490 
        nigrorum      palpebrosus          simplex 
       0.5066667        0.5500000        0.4388889 

$mean
[1] 0.4947745</code></pre>
</div>
</div>
</section>
<section id="a-score-optimization-graphs" class="level4">
<h4 class="anchored" data-anchor-id="a-score-optimization-graphs"><em>a</em>-score optimization graphs</h4>
<p>To get an optimal number of PCs for the DAPC iterate the calculation of the <em>a</em>-score across 100 replicate runs and for each, graph the distribution of the <em>a</em>-score for each number of PCs.</p>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>ZosteropsSNPsDAPC_OPTIMUM_RESULTS <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  ZosteropsSNPsDAPC_OPTIMUM_RESULTS[[i]] <span class="ot">&lt;-</span> <span class="fu">optim.a.score</span>(ZosteropsSNPsDAPC_OPTIMUM)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="4">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-1.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-2.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-3.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-4.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-5.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-6.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-7.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-8.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-9.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-10.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-11.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-12.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-13.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-14.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-15.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-16.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-17.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-18.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-19.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-20.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-21.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-22.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-23.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-24.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-25.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-26.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-27.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-28.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-29.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-30.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-31.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-32.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-33.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-34.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-35.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-36.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-37.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-38.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-39.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-40.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-41.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-42.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-43.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-44.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-45.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-46.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-47.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-48.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-49.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-50.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-51.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-52.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-53.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-54.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-55.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-56.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-57.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-58.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-59.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-60.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-61.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-62.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-63.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-64.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-65.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-66.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-67.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-68.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-69.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-70.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-71.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-72.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-73.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-74.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-75.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-76.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-77.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-78.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-79.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-80.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-81.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-82.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-83.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-84.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-85.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-86.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-87.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-88.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-89.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-90.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-91.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-92.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-93.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-94.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-95.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-96.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-97.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-98.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-99.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/A-score optimization graphs-100.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>Across 100 replicate runs of our iterated <em>a</em>-score calculation print the optimal number of PCs for each run. In each run the optimal number of PCs is that which maximizes the <em>a</em>-score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>OptimumPC_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="dv">100</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  OptimumPC <span class="ot">&lt;-</span> ZosteropsSNPsDAPC_OPTIMUM_RESULTS[[i]]<span class="sc">$</span>best</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(OptimumPC)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  OptimumPC_list[[i]] <span class="ot">&lt;-</span> OptimumPC</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8
[1] 8
[1] 8
[1] 8
[1] 20
[1] 21
[1] 8
[1] 8
[1] 23
[1] 8
[1] 8
[1] 23
[1] 21
[1] 8
[1] 20
[1] 8
[1] 8
[1] 8
[1] 8
[1] 8
[1] 23
[1] 8
[1] 8
[1] 8
[1] 23
[1] 9
[1] 8
[1] 8
[1] 8
[1] 8
[1] 23
[1] 8
[1] 8
[1] 8
[1] 21
[1] 9
[1] 8
[1] 8
[1] 8
[1] 8
[1] 8
[1] 8
[1] 8
[1] 9
[1] 8
[1] 22
[1] 8
[1] 24
[1] 8
[1] 21
[1] 21
[1] 8
[1] 8
[1] 8
[1] 23
[1] 8
[1] 8
[1] 8
[1] 8
[1] 8
[1] 7
[1] 22
[1] 8
[1] 9
[1] 21
[1] 8
[1] 8
[1] 8
[1] 8
[1] 8
[1] 24
[1] 8
[1] 8
[1] 20
[1] 8
[1] 9
[1] 8
[1] 8
[1] 8
[1] 8
[1] 8
[1] 22
[1] 8
[1] 8
[1] 23
[1] 8
[1] 8
[1] 8
[1] 9
[1] 21
[1] 7
[1] 8
[1] 9
[1] 21
[1] 8
[1] 21
[1] 9
[1] 24
[1] 8
[1] 8</code></pre>
</div>
</div>
<p>Produce a summary of the 100 iterated a-score estimates denoting the minimum and maximum number of optimal PCs across all runs as well as the median and mean optimal PCs and first and third quartiles. Use the median optimal number of PCs as a starting point in subsequent DAPC analyses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(OptimumPC_list, <span class="at">file =</span> <span class="st">"OptimumPC_results_n100.txt"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>OptimumPC_list <span class="ot">&lt;-</span> <span class="fu">unlist</span>(OptimumPC_list)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>OptimumPC_list_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(OptimumPC_list)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>OptimumPC_list_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   7.00    8.00    8.00   11.54   11.75   24.00 </code></pre>
</div>
</div>
</section>
<section id="dapc-scatter-plots-and-bar-graphs" class="level4">
<h4 class="anchored" data-anchor-id="dapc-scatter-plots-and-bar-graphs">DAPC scatter plots and bar graphs</h4>
<p>Conduct the final DAPC analysis with group assignments for each individual sample. Three runs will be repeated for this analysis. One of those runs uses the optimal number of PCs from the prior iterated <em>a</em>-score estimations (the median optimal number of PCs across 100 replicate runs of the optimal <em>a</em>-score estimation). The other two runs of the DAPC analysis are four PCs less than the optimal and four PCs greater than the optimal number of PCs. Generate a scatter plot from the DAPC analysis and a bar plot showing the probability of assignment for each individual sample. Save both the scatter plot and bar graphs as <code>pdf</code> files and generate a tab-delimited table of the results for each individual sample with the columns being the original assigned population, the sample, the population assigned by the DAPC, and the posterior probability of that particular assignment. In addition, for each replicate run generate a loading plot displaying how each SNP contributes to the PCs for the optimal number of PCs and four less than and four greater than the optimal number. Export each loading plot as a <code>pdf</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>n.pca.values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n.pca <span class="cf">in</span> n.pca.values) {</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  DAPCseed <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>, <span class="dv">1</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(DAPCseed)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(DAPCseed)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  ZosteropsSNPsDAPC <span class="ot">&lt;-</span> <span class="fu">dapc</span>(gl.ZosteropsSNPs, <span class="at">n.pca =</span> n.pca, <span class="at">n.da =</span> <span class="fu">nPop</span>(gl.ZosteropsSNPs)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  ZosteropsSNPsDAPC_contributions <span class="ot">&lt;-</span> <span class="fu">loadingplot</span>(ZosteropsSNPsDAPC<span class="sc">$</span>var.contr, <span class="at">axis =</span> <span class="dv">2</span>, <span class="at">thres =</span> <span class="fl">0.0025</span>, <span class="at">lab.jitter =</span> <span class="dv">1</span>)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  DAPCscatter <span class="ot">&lt;-</span> <span class="fu">scatter</span>(ZosteropsSNPsDAPC, <span class="at">col =</span> ColorPal_CUSTOM, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>, <span class="at">clabel =</span> F, <span class="at">posi.leg =</span> <span class="st">"bottomleft"</span>, <span class="at">scree.pca =</span> <span class="cn">TRUE</span>,</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">posi.pca =</span> <span class="st">"topright"</span>, <span class="at">cleg =</span> <span class="fl">0.75</span>)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  DAPCscatter</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  ZosteropsSNPsDAPCResults <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ZosteropsSNPsDAPC<span class="sc">$</span>posterior)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  ZosteropsSNPsDAPCResults<span class="sc">$</span>pop <span class="ot">&lt;-</span> <span class="fu">pop</span>(gl.ZosteropsSNPs)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  ZosteropsSNPsDAPCResults<span class="sc">$</span>indNames <span class="ot">&lt;-</span> <span class="fu">rownames</span>(ZosteropsSNPsDAPCResults)</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  ZosteropsSNPsDAPCResults <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(ZosteropsSNPsDAPCResults, <span class="sc">-</span><span class="fu">c</span>(pop, indNames))</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ZosteropsSNPsDAPCResults, <span class="at">n =</span> <span class="dv">11</span>)</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>  nPCAtitle <span class="ot">&lt;-</span> <span class="fu">paste</span>(n.pca, <span class="st">"principal components"</span>)</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(nPCAtitle)</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(ZosteropsSNPsDAPCResults) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Original_Pop"</span>,<span class="st">"Sample"</span>,<span class="st">"Assigned_Pop"</span>,<span class="st">"Posterior_membership_probability"</span>)</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>  DAPCbar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ZosteropsSNPsDAPCResults, <span class="fu">aes</span>(<span class="at">x=</span>Sample, <span class="at">y=</span>Posterior_membership_probability, <span class="at">fill=</span>Assigned_Pop))</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>  DAPCbar <span class="ot">&lt;-</span>  DAPCbar <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>) </span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>  DAPCbar <span class="ot">&lt;-</span>  DAPCbar <span class="sc">+</span> <span class="fu">ggtitle</span>(nPCAtitle)</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>  DAPCbar <span class="ot">&lt;-</span>  DAPCbar <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> ColorPal_CUSTOM) </span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>  DAPCbar <span class="ot">&lt;-</span>  DAPCbar <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>Original_Pop, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>  DAPCbar <span class="ot">&lt;-</span>  DAPCbar <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(DAPCbar)</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.table</span>(ZosteropsSNPsDAPCResults, <span class="at">file =</span> <span class="fu">paste</span>(<span class="st">"ZosteropsSNPsDAPCResults"</span>,<span class="st">"_"</span>,n.pca,<span class="st">"PCs.txt"</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 71</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC scatter and bar graphs-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC scatter and bar graphs-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "4 principal components"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC scatter and bar graphs-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 430</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC scatter and bar graphs-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC scatter and bar graphs-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "8 principal components"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC scatter and bar graphs-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 970</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC scatter and bar graphs-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC scatter and bar graphs-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "12 principal components"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ZosteropsSNPs_analysis_files/figure-html/DAPC scatter and bar graphs-9.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="close-log" class="level2">
<h2 class="anchored" data-anchor-id="close-log">Close log</h2>
<p>Close the log file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log_close</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-logr" class="csl-entry" role="listitem">
Bosak, David. 2024. <span>“Logr: Creates Log Files.”</span> <a href="https://CRAN.R-project.org/package=logr">https://CRAN.R-project.org/package=logr</a>.
</div>
<div id="ref-igraph" class="csl-entry" role="listitem">
Csardi, Gabor, and Tamas Nepusz. 2006. <span>“The Igraph Software Package for Complex Network Research”</span> Complex Systems: 1695. <a href="https://igraph.org">https://igraph.org</a>.
</div>
<div id="ref-deraad2024" class="csl-entry" role="listitem">
DeRaad, Devon, Marlon Cobos, Natalie Hofmeister, Lucas DeCicco, Madhvi Venkatraman, Isao Nishiumi, Bailey McKay, et al. 2024. <span>“On the Brink of Explosion? Identifying the Source and Potential Spread of Introduced Zosterops White-Eyes in North America.”</span> <em>Biological Invasions</em> 26 (5): 1615–39. <a href="https://doi.org/10.1007/s10530-024-03268-8">https://doi.org/10.1007/s10530-024-03268-8</a>.
</div>
<div id="ref-adegenet" class="csl-entry" role="listitem">
Jombart, T. 2008. <span>“Adegenet: A r Package for the Multivariate Analysis of Genetic Markers”</span> 24: 1403–5. <a href="https://doi.org/10.1093/bioinformatics/btn129">https://doi.org/10.1093/bioinformatics/btn129</a>.
</div>
<div id="ref-jombart2010" class="csl-entry" role="listitem">
Jombart, Thibaut, Sébastien Devillard, and François Balloux. 2010. <span>“Discriminant Analysis of Principal Components: A New Method for the Analysis of Genetically Structured Populations.”</span> <em>BMC Genetics</em> 11 (1): 94. <a href="https://doi.org/10.1186/1471-2156-11-94">https://doi.org/10.1186/1471-2156-11-94</a>.
</div>
<div id="ref-poppr" class="csl-entry" role="listitem">
Kamvar, Zhian, Javier Tabima, and Niklaus Grünwald. 2014. <span>“<em></em>Poppr<span></span>: An <span></span>r<span></span> Package for Genetic Analysis of Populations with Clonal, Partially Clonal, and/or Sexual Reproduction.”</span> 2: e281. <a href="https://doi.org/10.7717/peerj.281">https://doi.org/10.7717/peerj.281</a>.
</div>
<div id="ref-vcfR" class="csl-entry" role="listitem">
Knaus, Brian, and Niklaus Grünwald. 2017. <span>“<span></span>VCFR<span></span>: A Package to Manipulate and Visualize Variant Call Format Data in <span></span>r<span></span>”</span> 17. <a href="https://dx.doi.org/10.1111/1755-0998.12549">https://dx.doi.org/10.1111/1755-0998.12549</a>.
</div>
<div id="ref-umap" class="csl-entry" role="listitem">
Konopka, Tomasz. 2023. <span>“Umap: Uniform Manifold Approximation and Projection.”</span> <a href="https://CRAN.R-project.org/package=umap">https://CRAN.R-project.org/package=umap</a>.
</div>
<div id="ref-RColorBrewer" class="csl-entry" role="listitem">
Neuwirth, Erich. 2022. <span>“RColorBrewer: ColorBrewer Palettes.”</span> <a href="https://CRAN.R-project.org/package=RColorBrewer">https://CRAN.R-project.org/package=RColorBrewer</a>.
</div>
<div id="ref-vegan" class="csl-entry" role="listitem">
Oksanen, Jari, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R. B. O’Hara, et al. 2025. <span>“Vegan: Community Ecology Package.”</span> <a href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</a>.
</div>
<div id="ref-paradis2004" class="csl-entry" role="listitem">
Paradis, Emmanuel, Julien Claude, and Korbinian Strimmer. 2004. <span>“APE: Analyses of Phylogenetics and Evolution in R Language.”</span> <em>Bioinformatics</em> 20 (2): 289–90. <a href="https://doi.org/10.1093/bioinformatics/btg412">https://doi.org/10.1093/bioinformatics/btg412</a>.
</div>
<div id="ref-ape" class="csl-entry" role="listitem">
Paradis, Emmanuel, and Klaus Schliep. 2019. <span>“Ape 5.0: An Environment for Modern Phylogenetics and Evolutionary Analyses in <span></span>r<span></span>”</span> 35: 526–28. <a href="https://doi.org/10.1093/bioinformatics/bty633">https://doi.org/10.1093/bioinformatics/bty633</a>.
</div>
<div id="ref-plotly" class="csl-entry" role="listitem">
Sievert, Carson. 2020. <span>“Interactive Web-Based Data Visualization with r, Plotly, and Shiny.”</span> <a href="https://plotly-r.com">https://plotly-r.com</a>.
</div>
<div id="ref-uniform2024" class="csl-entry" role="listitem">
<span>“Uniform Manifold Approximation and Projection.”</span> 2024. <em>Nature Reviews Methods Primers</em> 4 (1). <a href="https://doi.org/10.1038/s43586-024-00369-5">https://doi.org/10.1038/s43586-024-00369-5</a>.
</div>
<div id="ref-htmlwidgets" class="csl-entry" role="listitem">
Vaidyanathan, Ramnath, Yihui Xie, JJ Allaire, Joe Cheng, Carson Sievert, and Kenton Russell. 2023. <span>“Htmlwidgets: HTML Widgets for r.”</span> <a href="https://CRAN.R-project.org/package=htmlwidgets">https://CRAN.R-project.org/package=htmlwidgets</a>.
</div>
<div id="ref-watterson1975" class="csl-entry" role="listitem">
Watterson, G. 1975. <span>“On the Number of Segregating Sites in Genetical Models Without Recombination.”</span> <em>Theoretical Population Biology</em> 7 (2): 256–76. <a href="https://doi.org/10.1016/0040-5809(75)90020-9">https://doi.org/10.1016/0040-5809(75)90020-9</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <span>“Ggplot2: Elegant Graphics for Data Analysis.”</span> <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-tidyr" class="csl-entry" role="listitem">
Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2024. <span>“Tidyr: Tidy Messy Data.”</span> <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>